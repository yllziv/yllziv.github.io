function updateSelectHistory(e){for(var o='<option selected="selected" class="display-none">请选择历史纪录</option>',t=0;t<e.length;t++)o+='<option value="'+e[t]+'">'+decodeURI(e[t])+"</option>";$(".json-history").html(o)}function formatJSON(txt,compress){var indentChar="    ";if(/^\s*$/.test(txt))return"数据为空,无法格式化! ";try{var data=eval("("+txt+")")}catch(e){return"数据源语法错误,格式化失败! 错误信息: "}var draw=[],last=!1,This=this,line=compress?"":"\n",nodeCount=0,maxDepth=0,notify=function(e,o,t,n,s){nodeCount++;for(var r=0,c="";r<n;r++)c+=indentChar;if(c=compress?"":c,maxDepth=++n,o&&o.constructor==Array){draw.push(c+(s?'"'+e+'":':"")+"["+line);for(var r=0;r<o.length;r++)notify(r,o[r],r==o.length-1,n,!1);draw.push(c+"]"+(t?line:","+line))}else if(o&&"object"==typeof o){draw.push(c+(s?'"'+e+'":':"")+"{"+line);var a=0,r=0;for(var i in o)a++;for(var i in o)notify(i,o[i],++r==a,n,!0);draw.push(c+"}"+(t?line:","+line))}else"string"==typeof o&&(o='"'+o+'"'),draw.push(c+(s?'"'+e+'":':"")+o+(t?"":",")+line)},isLast=!0,indent=0;return notify("",data,isLast,indent,!1),draw.join("")}$(document).ready(function(){function e(e,o){return js_source=e.replace(/^\s+/,""),tabsize=1,js_source&&"<"===js_source.charAt(0)?style_html(js_source,tabsize,o,80):js_beautify(js_source,tabsize,o)}function o(e,o){var t=e,n=new Packer;if(o)var s=n.pack(t,1,0);else var s=n.pack(t,0,0);return s}$("iframe",window.parent.document).height($("#tool").height()),$(window).resize(function(){$("iframe",window.parent.document).height($("#tool").height())});var t=[];window.localStorage.getItem("historyCompressArray")&&(t=window.localStorage.getItem("historyCompressArray").split(","),updateSelectHistory(t)),$("#compress-minijs-btn").on("click",function(){$("#destJSON").val(o($("#sourceJSON").val(),0))}),$("#compress-seminijs-btn").on("click",function(){$("#destJSON").val(o($("#sourceJSON").val(),1))}),$("#compress-4formatejs-btn").on("click",function(){$("#destJSON").val(e($("#sourceJSON").val(),"    "))}),$("#compress-2formatejs-btn").on("click",function(){$("#destJSON").val(e($("#sourceJSON").val(),"  "))}),$("#compress-tformatejs-btn").on("click",function(){$("#destJSON").val(e($("#sourceJSON").val(),"\t"))}),$("#compress-cssencode-btn").on("click",function(){$("#destJSON").val(CSSencode($("#sourceJSON").val()))}),$("#compress-cssdecode-btn").on("click",function(){$("#destJSON").val(CSSdecode($("#sourceJSON").val()))}),$("#compress-json-btn").on("click",function(){$("#destJSON").val(formatJSON($("#sourceJSON").val(),!0))}),$("#json-clean-btn").on("click",function(){window.localStorage.removeItem("historyCompressArray"),$("#destJSON").val(""),$("#rowJSON").val(""),$("#sourceJSON").val(""),$(".json-history").html('<option selected="selected" class="display-none">没有保存的纪录，请点击保存纪录按钮</option>')}),$("#json-save-btn").on("click",function(){t.push(encodeURI($("#sourceJSON").val())),window.localStorage.setItem("historyCompressArray",t),updateSelectHistory(t)}),$(".json-history").on("change",function(){$("#sourceJSON").val(decodeURI($(this).val()))})});