function show_msg(e,t,a){$("#status").removeClass("error").removeClass("success").removeClass("notice"),$("#status").addClass(e).html(t).fadeIn(function(){a>0&&setTimeout(function(){$("#status").fadeOut("fast")},a)})}function updateSelectHistory(e){for(var t='<option selected="selected" class="display-none">请选择历史纪录</option>',a=0;a<e.length;a++)t+='<option value="'+e[a]+'">'+JSON.parse(decodeURIComponent(e[a])).url+"</option>";$(".rest-history").html(t)}var historyRestArray=[];$(document).ready(function(){$("iframe",window.parent.document).height(900),window.localStorage.getItem("historyRestArray")&&(historyRestArray=window.localStorage.getItem("historyRestArray").split(","),updateSelectHistory(historyRestArray))}),$("body").on("change",".param-input",function(){$(this).attr("data-value",$(this).val())}),$("#clean").on("click",function(){window.localStorage.removeItem("historyRestArray"),$("#request_uri").val(""),$("#jsonparam").val(""),$("#param_template").nextAll().remove(),$("#request_header_template").nextAll().remove(),$(".rest-history").html('<option selected="selected" class="display-none">没有保存的纪录，请点击保存纪录按钮</option>')}),$("#save").on("click",function(){var e={url:$("#request_uri").val(),jsonparam:$("#jsonparam").val(),headerhtml:$("#request_header_template").parent().html(),paramhtml:$("#param_template").parent().html()};historyRestArray.push(encodeURIComponent(JSON.stringify(e))),window.localStorage.setItem("historyRestArray",historyRestArray),updateSelectHistory(historyRestArray)}),$(".rest-history").on("change",function(){var e=JSON.parse(decodeURIComponent($(this).val()));$("#request_uri").val(e.url),$("#jsonparam").val(e.jsonparam),$("#request_header_template").parent().html(e.headerhtml),$("#param_template").parent().html(e.paramhtml),$(".param-input").each(function(){$(this).val($(this).attr("data-value"))})}),$("#add_more_param").click(function(e){$("#jsonparam").val("").attr("disabled","true"),$(this).parent().append($("#param_template .param-pair").clone())}),$("#add_more_request_header").click(function(e){$(this).parent().append($("#request_header_template .request-header-pair").clone())}),$("fieldset").on("click","a.delete_this",function(e){return console.log("delete"),$(this).parent().remove(),1==$("#params .delete_this").length&&$("#jsonparam").val("").removeAttr("disabled"),!1}),$("#send").click(function(e){show_msg("info","正在请求..."),$("#response_wrapper").hide();var t=$("#method").val(),a=$("#request_uri").val(),r=[];$('input[name="param_key"]').each(function(e){var t=$(this).val();if(""!=t){var a=$(this).next('input[name="param_value"]').val();""!=a&&r.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}}),r=r.join("&"),0==r.length&&(r=$("#jsonparam").val());var s={};$('input[name="request_header_key"]').each(function(e){var t=$(this).val();if(""!=t){var a=$(this).next('input[name="request_header_value"]').val();""!=a&&(s[t]=a)}});var o=(new Date).getTime();$.ajax({url:a,type:t,data:r,dataType:"text",headers:s,complete:function(e,t){$("#response_wrapper").show(),0!=e.status?$("#response_status").html("状态码: "+e.status):$("#response_status").html(""),$("#response_headers").html(e.getAllResponseHeaders()),$("#response_body").html(e.responseText),$("iframe",window.parent.document).height($("#rest").height()+100)},error:function(e,t,a){show_msg("error",t,a)},success:function(e,t,a){var r=(new Date).getTime()-o;$("#response pre").css("border","1px solid #222"),show_msg("success","请求时间： "+r+"ms")}})});