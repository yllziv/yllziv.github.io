function jishi(){start_time>0&&(time_cha=get_time()-start_time,sudu_num=Math.round(typing_num/time_cha*6e4)),typing_num>0&&(right_num=Math.round(1e4*(1-error_num/typing_num))/100,jindu=Math.round((typing_num-error_num)/all_num*1e4)/100),document.getElementById("shijian").innerHTML="时间："+get_date(time_cha),document.getElementById("sudu").innerHTML="速度："+sudu_num+" KMP",document.getElementById("right_num").innerHTML="正确率："+right_num+" %",document.getElementById("jindu").innerHTML="进度："+jindu+" %",_jishi=setTimeout("jishi()",100)}function get_date(e){var t=new Date(e);return t.getMinutes()+"分"+t.getSeconds()+"秒"}function get_time(){var e=new Date;return e.getTime()}function show_key(){if(key_data[art_line]){var e=key_data[art_line].charCodeAt(art_num);show_text(),set_on(e,"on",1),set_shift(e)}else{clearTimeout(_jishi);var t=document.getElementById("art_text");t.style.paddingLeft="0px",t.innerHTML="<h3>O(∩_∩)O哈哈~ 恭喜你已经完成本次测试！</h3>",document.getElementById("jindu").innerHTML="进度：100 %"}}function show_sudu(){document.getElementById("shijian")}function set_shift(e){var t=/^(126|33|64|35|36|37|81|87|69|82|84|65|83|68|70|71|90|88|67|86|66)$/,n=/^(94|38|42|40|41|95|43|89|85|73|79|80|123|125|124|72|74|75|76|58|34|78|77|60|62|63)$/;set_on("991",null),set_on("992",null),e>=97&&e<=122?1==_capslk&&(e-=32,t.test(e)?set_on("992","on",1):n.test(e)&&set_on("991","on",1)):e>=65&&e<=90?1!=_capslk&&(t.test(e)?set_on("992","on",1):n.test(e)&&set_on("991","on",1)):t.test(e)?set_on("992","on",1):n.test(e)&&set_on("991","on",1)}function show_text(){if(key_data[art_line]){var e=document.getElementById("art_text");e.style.paddingLeft=Math.round((990-65*key_data[art_line].length)/2)+"px";for(var t="",n=0;n<key_data[art_line].length;n++)t+='<div class="b_'+(n==art_num?"on":"alt")+'"><ul><li>'+key_data[art_line].substr(n,1)+"</li></ul></div>";e.innerHTML=t}}function checkKey(e){if(key_data[art_line]){var t=get_keyCode(e),n=key_data[art_line].charCodeAt(art_num);0==start_time&&(start_time=get_time()),set_on(last_code,null),last_code=0,typing_num++,t==n?(set_on(t,null),art_num<key_data[art_line].length-1?art_num++:(art_num=0,art_line++)):(error_num++,code_code(t)!=code_code(n)&&(last_code=t,set_on(t,"err",1))),show_key()}return!1}function checkDown(e){var e=e?e:window.event?window.event:null,t=e.which?e.which:e.keyCode;return 8==t||9==t||32==t?(checkKey(e),!1):void(20==t&&(1==_capslk?(_capslk=0,set_on(20,null)):(_capslk=1,set_on(20,"on",1))))}function get_keyCode(e){var e=e?e:window.event?window.event:null,t=e.which?e.which:e.keyCode,n=e.shiftKey?e.shiftKey:16==t;return t>=65&&t<=90&&!n||t>=97&&t<=122&&n?(_capslk=1,set_on(20,"on",1)):(t>=65&&t<=90||t>=97&&t<=122)&&(_capslk=0,set_on(20,null)),t}function set_on(e,t,n){e=code_code(e);var _=document.getElementById("a_"+e);if("on"==t||"err"==t){if(_){if("on"==t){var a=/(_on)+$/i;a.test(_.className)||(_.className+="_on")}else{var a=/(_err)+$/i;a.test(_.className)||(_.className+="_err")}n||setTimeout(function(){set_on(e,null)},150)}}else _&&(_.className=_.className.replace(/(_on|_err)+$/i,""));return!0}function code_code(e){e>=65&&e<=90&&(e+=32);for(var t=new Array(126,33,64,35,36,37,94,38,42,40,41,95,43,60,62,63,58,34,123,125,124),n=new Array(96,49,50,51,52,53,54,55,56,57,48,45,61,44,46,47,59,39,91,93,92),_=0;_<t.length;_++)e=e==t[_]?n[_]:e;return e}function MM_jumpMenu(e){document.location=e.value}var _capslk=0,art_line=1,art_num=0,last_code=0,start_time=0,time_cha=0,typing_num=0,all_num=0,error_num=0,right_num="--",jindu=0,sudu_num="--",_jishi=null;if(""!=key_data){show_key(),jishi();for(var i=1;i<key_data.length;i++)all_num+=key_data[i].length}