!function(){function e(e,n,t,i){if(this.atOccurrence=!1,this.cm=e,null==i&&"string"==typeof n&&(i=!1),t=t?e.clipPos(t):{line:0,ch:0},this.pos={from:t,to:t},"string"!=typeof n)this.matches=function(t,i){if(t)for(var r=e.getLine(i.line).slice(0,i.ch),c=r.match(n),h=0;c;){var o=r.indexOf(c[0]);h+=o,r=r.slice(o+1);var s=r.match(n);if(!s)break;c=s,h++}else var r=e.getLine(i.line).slice(i.ch),c=r.match(n),h=c&&i.ch+r.indexOf(c[0]);if(c)return{from:{line:i.line,ch:h},to:{line:i.line,ch:h+c[0].length},match:c}};else{i&&(n=n.toLowerCase());var r=i?function(e){return e.toLowerCase()}:function(e){return e},c=n.split("\n");1==c.length?this.matches=function(t,i){var c,h=r(e.getLine(i.line)),o=n.length;if(t?i.ch>=o&&(c=h.lastIndexOf(n,i.ch-o))!=-1:(c=h.indexOf(n,i.ch))!=-1)return{from:{line:i.line,ch:c},to:{line:i.line,ch:c+o}}}:this.matches=function(n,t){var i=t.line,h=n?c.length-1:0,o=c[h],s=r(e.getLine(i)),f=n?s.indexOf(o)+o.length:s.lastIndexOf(o);if(!(n?f>=t.ch||f!=o.length:f<=t.ch||f!=s.length-o.length))for(;;){if(n?!i:i==e.lineCount()-1)return;if(s=r(e.getLine(i+=n?-1:1)),o=c[n?--h:++h],!(h>0&&h<c.length-1)){var l=n?s.lastIndexOf(o):s.indexOf(o)+o.length;if(n?l!=s.length-o.length:l!=o.length)return;var u={line:t.line,ch:f},a={line:i,ch:l};return{from:n?a:u,to:n?u:a}}if(s!=o)return}}}}e.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){function n(e){var n={line:e,ch:0};return t.pos={from:n,to:n},t.atOccurrence=!1,!1}for(var t=this,i=this.cm.clipPos(e?this.pos.from:this.pos.to);;){if(this.pos=this.matches(e,i))return this.atOccurrence=!0,this.pos.match||!0;if(e){if(!i.line)return n(0);i={line:i.line-1,ch:this.cm.getLine(i.line-1).length}}else{var r=this.cm.lineCount();if(i.line==r-1)return n(r);i={line:i.line+1,ch:0}}}},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(e){var n=this;this.atOccurrence&&(n.pos.to=this.cm.replaceRange(e,n.pos.from,n.pos.to))}},CodeMirror.defineExtension("getSearchCursor",function(n,t,i){return new e(this,n,t,i)})}();