<!doctype html><html class="theme-next pisces"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/vendors/fancybox/source/jquery.fancybox.css" rel="stylesheet" type="text/css"><link href="/vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="/css/main.css" rel="stylesheet" type="text/css"><meta name="keywords" content="JavaScript,"><link rel="alternate" href="/rss.xml" title="ziv小站" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"><meta name="description" content="概述使用正则已经很久了，边用边查的状态维持了很久，是时候写篇博文总结一下。捎带推广一下自己开发的一个小工具来现在检测正则表达式：在线正则表达式测试 正则表达式概念：指一个用来描述或者匹配一系列符合某个句法规则的字符串的单个字符串，主要用来验证（前后分别加上^和$）、搜索/替换（\b）。 JavaScript 中的 RegExp 对象创建一个正则表达式以字面量形式定义正则表达式1var expres"><meta name="keywords" content="JavaScript"><meta property="og:type" content="article"><meta property="og:title" content="使用 JavaScript 玩转正则表达式"><meta property="og:url" content="http://yanglonglong.com/blog/2016-06-20-使用-JavaScript-玩转正则表达式.html"><meta property="og:site_name" content="ziv小站"><meta property="og:description" content="概述使用正则已经很久了，边用边查的状态维持了很久，是时候写篇博文总结一下。捎带推广一下自己开发的一个小工具来现在检测正则表达式：在线正则表达式测试 正则表达式概念：指一个用来描述或者匹配一系列符合某个句法规则的字符串的单个字符串，主要用来验证（前后分别加上^和$）、搜索/替换（\b）。 JavaScript 中的 RegExp 对象创建一个正则表达式以字面量形式定义正则表达式1var expres"><meta property="og:locale" content="zh-Hans"><meta property="og:updated_time" content="2016-07-23T12:46:09.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="使用 JavaScript 玩转正则表达式"><meta name="twitter:description" content="概述使用正则已经很久了，边用边查的状态维持了很久，是时候写篇博文总结一下。捎带推广一下自己开发的一个小工具来现在检测正则表达式：在线正则表达式测试 正则表达式概念：指一个用来描述或者匹配一系列符合某个句法规则的字符串的单个字符串，主要用来验证（前后分别加上^和$）、搜索/替换（\b）。 JavaScript 中的 RegExp 对象创建一个正则表达式以字面量形式定义正则表达式1var expres"><script type="text/javascript" id="hexo.configuration">var NexT=window.NexT||{},CONFIG={scheme:"Pisces",sidebar:{position:"left",display:"post"},fancybox:!0,motion:!1,duoshuo:{userId:0x56ab38cf59400400,author:"博主"}};!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];"https"===e?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}();var _hmt=_hmt||[];!function(){var t=document.createElement("script");t.src="//hm.baidu.com/hm.js?830d141512282f99a813d8a04a08afde";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><title> 使用 JavaScript 玩转正则表达式 | ziv小站</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-76641751-1","auto"),ga("send","pageview")</script><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?830d141512282f99a813d8a04a08afde";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div class="container one-collumn sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">ziv小站</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">杨龙龙的个人博客</p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-home fa-fw"></i><br> 首页</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-archive fa-fw"></i><br> 归档</a></li><li class="menu-item menu-item-life"><a href="/life" rel="section"><i class="menu-item-icon fa fa-life-ring fa-fw"></i><br> 生活</a></li><li class="menu-item menu-item-photos"><a href="/photos" rel="section"><i class="menu-item-icon fa fa-camera-retro fa-fw"></i><br> 相册</a></li><li class="menu-item menu-item-grid"><a href="/grid" rel="section"><i class="menu-item-icon fa fa-calendar fa-fw"></i><br> 格志</a></li><li class="menu-item menu-item-tool"><a href="/tool" rel="section"><i class="menu-item-icon fa fa-legal fa-fw"></i><br> 工具</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline"> 使用 JavaScript 玩转正则表达式</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2016-06-20T19:41:40+08:00" content="2016-06-20">2016-06-20</time></span> <span class="post-category">&nbsp; | &nbsp;<span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a href="/categories/tool/" itemprop="url" rel="index"><span itemprop="name">tool</span></a></span></span> <span id="/blog/2016-06-20-使用-JavaScript-玩转正则表达式.html" class="leancloud_visitors" data-flag-title="使用 JavaScript 玩转正则表达式">&nbsp; | &nbsp;<span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数</span><span class="leancloud-visitors-count"></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>使用正则已经很久了，边用边查的状态维持了很久，是时候写篇博文总结一下。<br>捎带推广一下自己开发的一个小工具来现在检测正则表达式：<a href="http://yanglonglong.com/tool/regular.html">在线正则表达式测试</a></p><p>正则表达式概念：指一个用来描述或者匹配一系列符合某个句法规则的字符串的单个字符串，主要用来验证（前后分别加上^和$）、搜索/替换（\b）。</p><h2 id="JavaScript-中的-RegExp-对象"><a href="#JavaScript-中的-RegExp-对象" class="headerlink" title="JavaScript 中的 RegExp 对象"></a>JavaScript 中的 RegExp 对象</h2><h3 id="创建一个正则表达式"><a href="#创建一个正则表达式" class="headerlink" title="创建一个正则表达式"></a>创建一个正则表达式</h3><h4 id="以字面量形式定义正则表达式"><a href="#以字面量形式定义正则表达式" class="headerlink" title="以字面量形式定义正则表达式"></a>以字面量形式定义正则表达式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> expression = <span class="regexp">/pattern/</span>flags;</div></pre></td></tr></table></figure><p>其中pattern是正则表达式，可以包括字符类、限定符、分组、向前查找以及反向引用。<br>flags用以标明正则表达式的匹配模式(行为)：</p><ul><li>g——全局模式，表示正则表达式将被用于所有字符串；</li><li>i——表示不区分大小写；</li><li>m——表示多行模式，到达一行文本末尾时还会继续查找下一行中是否存在与模式匹配的项。</li></ul><h4 id="以RegExp构造函数定义正则表达式"><a href="#以RegExp构造函数定义正则表达式" class="headerlink" title="以RegExp构造函数定义正则表达式"></a>以RegExp构造函数定义正则表达式</h4><p>它接受两个参数：(要匹配的字符串模式，标志字符串(可选的))<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> expression = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"[bc]at"</span>,<span class="string">"i"</span>);</div></pre></td></tr></table></figure><p></p><p>匹配第一个’bat’或者’cat’，不区分大小写。RegExp构造函数的模式参数是字符串，所有元字符必须双重转义。</p><p>注意：正则表达式需要转移的字符：() [] {} + * ^ &amp; | ? . \</p><h3 id="RegExp实例属性"><a href="#RegExp实例属性" class="headerlink" title="RegExp实例属性"></a>RegExp实例属性</h3><ul><li>global：布尔值，表示是否设置了g标志。</li><li>ignoreCase：布尔值，表示是否设置了i标志。</li><li>multiline：布尔值，表示是否设置了m表示。</li><li>lastIndex：整数，表示开始搜索下一个匹配项的字符位置，从0开始。</li><li>sourse：正则表达式的字符串表示，按照字面量形式，而非传入构造函数中的字符串模型返回。</li></ul><h3 id="RegExp实例方法"><a href="#RegExp实例方法" class="headerlink" title="RegExp实例方法"></a>RegExp实例方法</h3><p>两个主要的方法：exec() / test()</p><h4 id="exec"><a href="#exec" class="headerlink" title="exec()"></a>exec()</h4><p>exec()专门为捕获组设计，接受一个参数：(要应用模式的字符串)。<br>如果 exec() 找到了匹配的文本，则返回一个结果数组。否则，返回 null。此数组的第 0 个元素是与正则表达式相匹配的文本，第 1 个元素是与 RegExpObject 的第 1 个子表达式相匹配的文本（如果有的话），第 2 个元素是与 RegExpObject 的第 2 个子表达式相匹配的文本（如果有的话），以此类推。</p><p>该数组包括两个额外属性：</p><ul><li>index——表示匹配项在字符串中的位置</li><li>input——表示应用正则表达式的字符串。</li></ul><p>返回的数组中第一项是与整个模型匹配的字符串，其他项是与模式中捕获组匹配的字符串。</p><p>注意：在循环中反复地调用 exec() 方法是<strong>唯一一种获得全局模式的完整模式匹配信息的方法</strong>。如：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> result = [];</div><div class="line"><span class="keyword">var</span> str = <span class="string">'yanglonglong'</span>;</div><div class="line"><span class="keyword">var</span> patt = <span class="regexp">/ong/g</span>;</div><div class="line"><span class="keyword">var</span> tmp;</div><div class="line"><span class="keyword">while</span>((tmp = patt.exec(str)) != <span class="literal">null</span>)&#123;</div><div class="line">  result.push(tmp.index + <span class="string">':'</span> + tmp)</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(result); <span class="comment">// ["5:ong", "9:ong"]</span></div></pre></td></tr></table></figure><p></p><h4 id="test"><a href="#test" class="headerlink" title="test()"></a>test()</h4><p>test()方法接受一个字符串参数，该模式与该参数匹配的情况下返回true，否则返回false。常用在if语句中。</p><h4 id="其他方法"><a href="#其他方法" class="headerlink" title="其他方法"></a>其他方法</h4><p>toLocaleString()和toString()方法都会返回正则表达式的字面量，与创建正则表达式的方式无关。<br>valueOf()方法返回正则表达式本身。</p><h3 id="RegExp构造函数属性"><a href="#RegExp构造函数属性" class="headerlink" title="RegExp构造函数属性"></a>RegExp构造函数属性</h3><p>这些属性适用于作用域中的所有正则表达式，并且基于所执行的最近一次正则表达式操作而变化。</p><ul><li>input，$_ 最近一次要匹配的字符串。</li><li>lastMatch $&amp; 最近一次的匹配项。</li><li>lastParen $+ 最近一次匹配的捕获组。</li><li>leftContex $^ input字符串中lastMatch之前的文本</li><li>multiline $* 布尔值，表示是否所有表达式都使用多行模式。</li><li>rightContext $` input字符串中lastMatch之后的文本。</li><li>RegExp.1，RegExp.2，……，RegExp.$9 用于存储第一、第二、……、第九个匹配的捕获组。<br>这些属性可以从exec()或test()执行的操作中提取出更具体的信息。</li></ul><h3 id="JavaScript-对正则支持的局限性"><a href="#JavaScript-对正则支持的局限性" class="headerlink" title="JavaScript 对正则支持的局限性"></a>JavaScript 对正则支持的局限性</h3><p>不支持的特性包括：匹配字符串开始和结尾的\A和\Z锚；向后查找lookbehind；并集和交集类；原子组；Unicode支持（单个字符除外，如\uFFFF）；命名的捕获组；s单行和x无间隔的匹配模式；条件匹配；正则表达式注释。</p><h2 id="JavaScript-中字符串对正则的支持"><a href="#JavaScript-中字符串对正则的支持" class="headerlink" title="JavaScript 中字符串对正则的支持"></a>JavaScript 中字符串对正则的支持</h2><p>JavaScript 中字符串有如下几个方法支持正则表达式：</p><ul><li>replace // 替换与正则表达式匹配的子串</li><li>match // 找到一个或多个正则表达式的匹配</li><li>split // 把字符串分割为字符串数组</li><li>search // ,检索与正则表达式相匹配的值</li></ul><h3 id="replace"><a href="#replace" class="headerlink" title="replace()"></a>replace()</h3><p>普通替换<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str =<span class="string">"some money"</span>;</div><div class="line">alert(str.replace(<span class="string">"some"</span>,<span class="string">"much"</span>)); <span class="comment">// much money</span></div></pre></td></tr></table></figure><p></p><p>使用正则表达式全局替换<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str =<span class="string">"some money"</span>;</div><div class="line">alert(str.replace(<span class="regexp">/o/g</span>,<span class="string">"O"</span>)); <span class="comment">// sOme mOney</span></div></pre></td></tr></table></figure><p></p><p>在正则中使用捕获<br>$0 表示匹配到的数据；$1 表示第一个捕获组；$2 表示第二个捕获组<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">re = <span class="regexp">/(\d)\s(\d)/</span>;</div><div class="line">str = <span class="string">"1234 5678"</span>;</div><div class="line">alert(str.replace(re,<span class="string">"  $2,$1  "</span>)); <span class="comment">// 123  5,4  678</span></div></pre></td></tr></table></figure><p></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f2c</span>(<span class="params">s</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> test = <span class="regexp">/([\d]&#123;4&#125;)-([\d]&#123;1,2&#125;)-([\d]&#123;1,2&#125;)/</span>;</div><div class="line">  <span class="keyword">return</span> s.replace(test, <span class="function"><span class="keyword">function</span>(<span class="params">$<span class="number">0</span>,$<span class="number">1</span>,$<span class="number">2</span>,$<span class="number">3</span></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span>($<span class="number">2</span> +<span class="string">"/"</span> + $<span class="number">1</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(f2c(<span class="string">"today: 2011-03-29"</span>)); <span class="comment">// today: 03/2011</span></div><div class="line"><span class="comment">// $0: 2011-03-29</span></div></pre></td></tr></table></figure><p>注意，replace 第二个参数可以是字符串，也可以是函数。</p><h4 id="replace-第二个参数是字符串"><a href="#replace-第二个参数是字符串" class="headerlink" title="replace 第二个参数是字符串"></a>replace 第二个参数是字符串</h4><p>如果它是字符串，那么每个匹配都将由字符串替换。但是字符串中的 $ 字符具有特定的含义：<br>$1、$2、…、$99：与 regexp 中的第 1 到第 99 个子表达式相匹配的文本。<br>$&amp;/$0：与 regexp 相匹配的子串。<br>$`：位于匹配子串左侧的文本。<br>$’：位于匹配子串右侧的文本。<br>$$：表示 $ 符号。</p><h4 id="replace-第二个参数是函数"><a href="#replace-第二个参数是函数" class="headerlink" title="replace 第二个参数是函数"></a>replace 第二个参数是函数</h4><p>函数的第一个参数是匹配模式的字符串。<br>接下来的参数是与模式中的子表达式匹配的字符串，可以有 0 个或多个这样的参数。<br>接下来的参数是一个整数，声明了匹配在 stringObject 中出现的位置。<br>最后一个参数是 stringObject 本身。</p><h3 id="match"><a href="#match" class="headerlink" title="match()"></a>match()</h3><p>match()本质上与调用RegExp的exec()方法相同。<br>match()方法接收一个参数（正则表达式或者RegExp对象），返回数组。数组第一项是与整个模式匹配的字符串，之后的每一项保存着与正则表达式中的铺货组匹配的字符串。<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'yanglonglong'</span>.match(<span class="regexp">/l(o)n(g)/</span>)</div><div class="line"><span class="comment">// ["long", "o", "g"]</span></div></pre></td></tr></table></figure><p></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'yanglongdongw'</span>.match(<span class="regexp">/\wong(?=w)/</span>)</div><div class="line"><span class="comment">// ["dong"]</span></div></pre></td></tr></table></figure><p>若是全局匹配，则返回所有匹配结果组成的数组<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">"My name is CJ.Hello everyone!"</span>;</div><div class="line"><span class="keyword">var</span> re = <span class="regexp">/[A-Z]/g</span>;<span class="comment">//匹配所有大写字母</span></div><div class="line"><span class="keyword">var</span> arr = str.match(re);<span class="comment">//返回数组</span></div><div class="line"><span class="comment">// "M", "C", "J", "H"]</span></div></pre></td></tr></table></figure><p></p><h3 id="split"><a href="#split" class="headerlink" title="split()"></a>split()</h3><p>split()基于指定的分隔符将一个字符串分割成多个子字符串，并将结果放在一个数组中返回。<br>分隔符可以是字符串／RegExp对象。<br>split()可以接受第二个可选参数，用于指定数组大小。<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">str = <span class="string">"a_db-c"</span>;</div><div class="line">re=<span class="regexp">/[^a-z]/i</span>;</div><div class="line">arr = str.split(re);<span class="comment">//["a","bd","c"];</span></div></pre></td></tr></table></figure><p></p><h3 id="search"><a href="#search" class="headerlink" title="search()"></a>search()</h3><p>在字符串中查找时我们常用indexOf,与之对应用于正则查找的方法是search。<br>search()参数与match()相同，返回字符串中第一个匹配项的索引/-1，始终从字符串开头向后查找。<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">str = <span class="string">"My age is 18.Golden age!"</span>;<span class="comment">//年龄不是一定的,我们用indexOf不能查找它的位置</span></div><div class="line">re = <span class="regexp">/\d+/</span>;</div><div class="line">alert(str.search(re));<span class="comment">//返回查找到的字符串开始下标10</span></div></pre></td></tr></table></figure><p></p><h2 id="正则表达式元字符"><a href="#正则表达式元字符" class="headerlink" title="正则表达式元字符"></a>正则表达式元字符</h2><h3 id="简单元字符"><a href="#简单元字符" class="headerlink" title="简单元字符"></a>简单元字符</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">.   匹配除换行符以外的任意字符，包括空格</div><div class="line">^   匹配字符串的开始/一行的开始</div><div class="line">$   匹配字符串的结束/一行的结束</div><div class="line">\d  匹配一位数字,等价于[0-9]。</div><div class="line">\b  单词的开头或结尾，也就是单词的分界处（单词的开头\&lt; 单词的结尾\&gt;）</div><div class="line">\w  匹配字母或、数字、下划线,等价于[A-Za-z0-9_]</div><div class="line">\s  匹配任何的空白符，包括换行符</div><div class="line">\z  匹配字符串的末尾</div><div class="line">\g  匹配的起始位置，或者是上一次匹配的结束位置</div><div class="line">\1,\2 反向引用，匹配之前的第一、第二组括号内的字表达式匹配的文本</div><div class="line">（在 js 中使用 <span class="variable">$1</span> <span class="variable">$2</span>）。</div><div class="line"></div><div class="line">\A  字符串开头(类似^，但不受处理多行选项的影响)</div><div class="line">\Z  字符串结尾或行尾(不受处理多行选项的影响)</div><div class="line">\G  当前搜索的开头</div><div class="line">\D  匹配非数字的字符,等价于[^0-9]。</div><div class="line">\B  匹配不是单词的开头或结尾的字符</div><div class="line">\W  匹配不是字母或、数字、下划线的字符</div><div class="line">\S  匹配任何不是空白符的字符</div><div class="line"></div><div class="line">\t  水平制表符</div><div class="line">\v  垂直制表符</div><div class="line">\n  换行符</div><div class="line">\r  回车符</div><div class="line">\a  报警</div><div class="line">\f  换页符</div><div class="line">\e  Escape</div></pre></td></tr></table></figure><h3 id="复杂元字符"><a href="#复杂元字符" class="headerlink" title="复杂元字符"></a>复杂元字符</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">* 指定*前边的内容可以连续重复使用任意次（&gt;=0）</div><div class="line">+   指定+前边的内容可以连续重复使用任意次（&gt;=1）</div><div class="line">?   指定+前边的内容可以连续重复使用(i == 0 or i ==1)</div><div class="line"></div><div class="line">-  表示一个范围，如[0-9]/[a-z]</div><div class="line">&#123;n&#125;   &#123;&#125;前面的元字符必须连续重复匹配n次</div><div class="line">&#123;n,&#125;  &#123;&#125;前面的元字符必须连续重复匹配n次或者更多次</div><div class="line">&#123;n,m&#125; &#123;&#125;前面的元字符重复匹配要大于n次，小于m次</div><div class="line"></div><div class="line">*? 指定*前边的内容可以连续重复使用任意次（&gt;=0）,但尽可能少，忽略优先</div><div class="line">+? 指定+前边的内容可以连续重复使用任意次（&gt;=1）,但尽可能少</div><div class="line">?? 指定+前边的内容可以连续重复使用(i == 0 or i ==1),但尽可能少</div><div class="line">&#123;n&#125;? &#123;&#125;前面的元字符必须连续重复匹配n次,但尽可能少</div><div class="line">&#123;n,m&#125;? &#123;&#125;前面的元字符重复匹配要大于等于n次，小于m次,但尽可能少</div><div class="line"></div><div class="line"></div><div class="line">[xyz]   字符组，只能匹配一个字符</div><div class="line">[^xyz]  排除型字符组，匹配未包含的任意字符，必须匹配一个字符</div><div class="line">[^x]    匹配除了x以外的任意字符</div><div class="line">[^aeiou] 匹配除了aeiou这几个字母以外的任意字符</div><div class="line">x|y      分隔不同的规则，作为分支条件，匹配x或y，遵循取短原则</div><div class="line"></div><div class="line">(exp)  匹配exp，并捕获文本到自动命名的组里：例如([a-z])([0-9])\1\2，\1代表([a-z])匹配的内容，\2代表([0-9])匹配的内容。</div><div class="line">(?:exp)      非捕获型括号，匹配exp，不捕获匹配的文本，也不给此分组分配组号</div><div class="line">(?<span class="comment">#comment)和#....  包含注释comment ，最好忽略模式里的空白符，从而添加多行注释。</span></div><div class="line">(?=……)    肯定顺序环视      子表达式能够匹配右侧文本</div><div class="line">(?!……)    否定顺序环视    子表达式不能匹配右侧文本</div></pre></td></tr></table></figure><h3 id="JavaScript-不支持的元字符"><a href="#JavaScript-不支持的元字符" class="headerlink" title="JavaScript 不支持的元字符"></a>JavaScript 不支持的元字符</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(?<span class="xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>exp)  匹配exp，并捕获文本到名称为name的组里</span></div><div class="line">(?'name'exp) 匹配exp，并捕获文本到名称为name的组里</div><div class="line">(?<span class="tag">&lt;<span class="name">=……)</span>   肯定逆序环视   子表达式能够匹配左侧文本</span></div><div class="line">(?&lt;!……)   否定逆序环视    子表达式不能匹配左侧文本</div><div class="line">(?&gt;……)    固化分组</div></pre></td></tr></table></figure><h3 id="正则表达式修饰符"><a href="#正则表达式修饰符" class="headerlink" title="正则表达式修饰符"></a>正则表达式修饰符</h3><ul><li>i 忽略大小写</li><li>g 全局匹配</li><li>m 修改^和$在正则表达式中的作用，让它们分别表示行首和行尾，之前是字符串开头和结尾</li></ul><h2 id="正则表达式举例"><a href="#正则表达式举例" class="headerlink" title="正则表达式举例"></a>正则表达式举例</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div></pre></td><td class="code"><pre><div class="line">精确地查找net这个单词</div><div class="line">\bnet\b</div><div class="line"></div><div class="line">http后面不远处跟着一个net(不能换行)</div><div class="line">\bhttp\b.*\b.net\b</div><div class="line"></div><div class="line">以0开头，然后是两个数字，然后是一个连字号“-”，最后是8个数字</div><div class="line">0\d\d-\d\d\d\d\d\d\d\d   化简为0\d&#123;2&#125;-\d&#123;8&#125;</div><div class="line"></div><div class="line">填写的QQ号必须为5位到12位数字</div><div class="line">^\d&#123;5,12&#125;$</div><div class="line"></div><div class="line">匹配刚好6个字符的单词</div><div class="line">\b\w&#123;6&#125;\</div><div class="line"></div><div class="line">匹配以字母a开头的单词</div><div class="line">(\b):\ba\w*\b</div><div class="line"></div><div class="line">匹配1个或更多连续的数字</div><div class="line"> \d+</div><div class="line"></div><div class="line">查找元字符，例如<span class="string">"."</span>  <span class="string">"*"</span>  <span class="string">"\"，要使用转义字符</span></div><div class="line">\.   \*  \\</div><div class="line"></div><div class="line">匹配Windows后面跟1个或更多数字</div><div class="line">Windows\d+</div><div class="line"></div><div class="line">匹配一行的第一个单词(或整个字符串的第一个单词)</div><div class="line">^\w+</div><div class="line"></div><div class="line">匹配几种格式的电话号码，像(010)88886666，或022-22334455，或02912345678等</div><div class="line">\(?0\d&#123;2&#125;[) -]?\d&#123;8&#125;或者\(?0\d&#123;2&#125;\)?-?\d&#123;8&#125;</div><div class="line"></div><div class="line">匹配两种以连字号分隔的电话号码：</div><div class="line">一种是三位区号，8位本地号(如010-12345678)，一种是4位区号，7位本地号(0376-2233445)</div><div class="line">0\d&#123;2&#125;-\d&#123;8&#125;|0\d&#123;3&#125;-\d&#123;7&#125;</div><div class="line"></div><div class="line">匹配3位区号的电话号码，其中区号可以用小括号括起来，也可以不用，</div><div class="line">区号与本地号间可以用连字号或空格间隔，也可以没有间隔</div><div class="line">\(\d&#123;3&#125;\)\d&#123;8&#125;|\d&#123;3&#125;-\d&#123;8&#125;|\d&#123;3&#125;\d&#123;8&#125;</div><div class="line"></div><div class="line">IP地址匹配表达式</div><div class="line">([01]?\d\d\.|2[0-4]\d\.|25[0-5]\d.)&#123;3&#125;[01]?\d\d|2[0-4]\d|25[0-5]\d</div><div class="line"></div><div class="line">从路径中获取文件名</div><div class="line">[^/]*$</div><div class="line"></div><div class="line">所在路径和文件名</div><div class="line">^(.*)/(.*) <span class="variable">$1</span>和<span class="variable">$2</span>来提取这两者。</div><div class="line"></div><div class="line">去除文本首尾的空白字符</div><div class="line">s/^\s+//;</div><div class="line">s/\s+$//;</div><div class="line">s/\s*(.*?)\s*$/<span class="variable">$1</span>/s</div><div class="line"></div><div class="line">检查HTTP URL：</div><div class="line">^http://([^/:]+)(:(\d+))?(/.*)?$</div><div class="line"></div><div class="line">匹配引号内的字符串</div><div class="line">“[^”]*”</div><div class="line"></div><div class="line">匹配Jan 31之类的日期</div><div class="line">Jan ([12][0-9] | 3[01] | 0? [1-9])</div><div class="line"></div><div class="line">匹配不包含空白符的字符串</div><div class="line">\S+</div><div class="line"></div><div class="line">匹配用尖括号括起来的以a开头的字符串</div><div class="line">&lt;a[^&gt;]+&gt;</div><div class="line"></div><div class="line">匹配温度：</div><div class="line">/^([-+]?[0-9]+(\.[0-9]*)?)([CF])$/   数字保存在<span class="variable">$1</span>，小数保存在<span class="variable">$2</span>，C/F保存在<span class="variable">$3</span>。</div><div class="line"></div><div class="line">单词起始分界符</div><div class="line">(?&lt;!\w)(?=\w)</div><div class="line"></div><div class="line">单词结束分界符</div><div class="line">(?&lt;=\w)(?!\w)</div><div class="line"></div><div class="line">匹配主机名</div><div class="line">[-a-z0-9]+(\.[-a-z0-9]+)*\.(com|edu|info)</div><div class="line"></div><div class="line">匹配连续行</div><div class="line">^\w+=([^\n\\]|\\,)*</div><div class="line"></div><div class="line">网址（URL）</div><div class="line">[a-zA-z]+://[^\s]*</div><div class="line"></div><div class="line">电子邮件(Email)</div><div class="line">\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*</div><div class="line"></div><div class="line">QQ号码</div><div class="line">[1-9]\d&#123;4,&#125;</div><div class="line"></div><div class="line">HTML标记(包含内容或自闭合)</div><div class="line">&lt;(.*)(.*)&gt;.*&lt;\/\1&gt;|&lt;(.*) \/&gt;</div><div class="line"></div><div class="line">密码(由数字/大写字母/小写字母/标点符号组成，四种都必有，8位以上)</div><div class="line">(?=^.&#123;8,&#125;$)(?=.*\d)(?=.*\W+)(?=.*[A-Z])(?=.*[a-z])(?!.*\n).*$</div><div class="line"></div><div class="line">日期(年-月-日)</div><div class="line">(\d&#123;4&#125;|\d&#123;2&#125;)-((1[0-2])|(0?[1-9]))-(([12][0-9])|(3[01])|(0?[1-9]))</div><div class="line"></div><div class="line">日期(月/日/年)</div><div class="line">((1[0-2])|(0?[1-9]))/(([12][0-9])|(3[01])|(0?[1-9]))/(\d&#123;4&#125;|\d&#123;2&#125;)</div><div class="line"></div><div class="line">时间(小时:分钟, 24小时制)</div><div class="line">((1|0?)[0-9]|2[0-3]):([0-5][0-9])</div><div class="line"></div><div class="line">汉字(字符)</div><div class="line">[\u4e00-\u9fa5]</div><div class="line"></div><div class="line">中文及全角标点符号(字符)</div><div class="line">[\u3000-\u301e\ufe10-\ufe19\ufe30-\ufe44\ufe50-\ufe6b\uff01-\uffee]</div><div class="line"></div><div class="line">中国大陆固定电话号码</div><div class="line">(\d&#123;4&#125;-|\d&#123;3&#125;-)?(\d&#123;8&#125;|\d&#123;7&#125;)</div><div class="line"></div><div class="line">中国大陆手机号码</div><div class="line">1\d&#123;10&#125;</div><div class="line"></div><div class="line">中国大陆邮政编码</div><div class="line">[1-9]\d&#123;5&#125;</div><div class="line"></div><div class="line">中国大陆身份证号(15位或18位)</div><div class="line">\d&#123;15&#125;(\d\d[0-9xX])?</div><div class="line"></div><div class="line">非负整数(正整数或零)</div><div class="line">\d+</div><div class="line"></div><div class="line">正整数</div><div class="line">[0-9]*[1-9][0-9]*</div><div class="line"></div><div class="line">负整数</div><div class="line">-[0-9]*[1-9][0-9]*</div><div class="line"></div><div class="line">整数</div><div class="line">-?\d+</div><div class="line"></div><div class="line">小数</div><div class="line">(-?\d+)(\.\d+)?</div><div class="line"></div><div class="line">不包含abc的单词</div><div class="line">\b((?!abc)\w)+\b</div></pre></td></tr></table></figure><h2 id="向后引用"><a href="#向后引用" class="headerlink" title="向后引用"></a>向后引用</h2><p>使用小括号指定一个子表达式后，匹配这个子表达式的文本(也就是此分组捕获的内容)可以在表达式或其它程序中作进一步的处理。默认情况下，每个分组会自动拥有一个组号，规则是：从左向右，以分组的左括号为标志，第一个出现的分组的组号为1，第二个为2，以此类推。</p><p>后向引用用于重复搜索前面某个分组匹配的文本。例如，\1代表分组1匹配的文本。匹配重复的单词，像go go, 或者kitty kitty：</p><p>\b(\w+)\b\s+\1\b<br>这个表达式首先是一个单词，也就是单词开始处和结束处之间的多于一个的字母或数字(\b(\w+)\b)，这个单词会被捕获到编号为1的分组中，然后是1个或几个空白符(\s+)，最后是分组1中捕获的内容（也就是前面匹配的那个单词）(\1)。</p><p>指定表达式组名：(?<word>\w+)或者(?’Word’\w+),这样就把\w+的组名指定为Word了。要反向引用这个分组捕获的内容，可以使用\k<word>,所以上一个例子也可以写成这样：\b(?<word>\w+)\b\s+\k<word>\b。</word></word></word></word></p><p>可以使用(?:exp)这样的语法来剥夺一个分组对组号分配的参与权。其中分组0对应整个正则表达式。<br>实际上组号分配过程是要从左向右扫描两遍的：第一遍只给未命名组分配，第二遍只给命名组分配－－因此所有命名组的组号都大于未命名的组号</p><h2 id="零宽断言"><a href="#零宽断言" class="headerlink" title="零宽断言"></a>零宽断言</h2><p>用于查找在某些内容(但并不包括这些内容)之前或之后的东西，也就是说它们像\b,^,$那样用于指定一个位置，这个位置应该满足一定的条件(即断言)，因此它们也被称为零宽断言。</p><p>断言用来声明一个应该为真的事实。正则表达式中只有当断言为真时才会继续进行匹配。</p><p><strong>(?=exp)</strong>也叫零宽度正预测先行断言，它断言自身出现的位置的后面能匹配表达式exp。<br>比如\b\w+(?=ing\b)，匹配以ing结尾的单词的前面部分(除了ing以外的部分)，如查找I’m singing while you’re dancing.时，它会匹配sing和danc。</p><p><strong>(?&lt;=exp)</strong>也叫零宽度正回顾后发断言，它断言自身出现的位置的前面能匹配表达式exp。<br>比如(?&lt;=\bre)\w+\b会匹配以re开头的单词的后半部分(除了re以外的部分)，例如在查找reading a book时，它匹配ading。</p><p>JavaScript连逆序环视（Lookbehind,如(?&lt;=ab)c）都不支持，而perl和python是支持的。</p><p>假如你想要给一个很长的数字中每三位间加一个逗号(当然是从右边加起了)，你可以这样查找需要在前面和里面添加逗号的部分：((?&lt;=\d)\d{3})+\b，用它对1234567890进行查找时结果是234567890。</p><p>下面这个例子同时使用了这两种断言：(?&lt;=\s)\d+(?=\s)匹配以空白符间隔的数字(再次强调，不包括这些空白符)</p><h2 id="负向零宽断言"><a href="#负向零宽断言" class="headerlink" title="负向零宽断言"></a>负向零宽断言</h2><p>引子：只是想要确保某个字符没有出现，但并不想去匹配它。</p><p>例如，如果我们想查找这样的单词–它里面出现了字母q,但是q后面跟的不是字母u,我们可以尝试这样：\b\w<em>q[^u]\w</em>\b匹配包含后面不是字母u的字母q的单词。如果q出现在单词的结尾的话，像Iraq,Benq，这个表达式就会出错，因为[^u]总要匹配一个字符，所以如果q是单词的最后一个字符的话，后面的[^u]将会匹配q后面的单词分隔符(可能是空格，或者是句号或其它的什么)，后面的\w<em>\b将会匹配下一个单词，于是\b\w</em>q[^u]\w*\b就能匹配整个Iraq fighting。</p><p>负向零宽断言能解决这样的问题，因为它只匹配一个位置，并不消费任何字符。现在，我们可以这样来解决这个问题：\b\w<em>q(?!u)\w</em>\b。</p><p>零宽度负预测先行断言<strong>(?!exp)</strong>，断言此位置的后面不能匹配表达式exp。<br>例如：\d{3}(?!\d)匹配三位数字，而且这三位数字的后面不能是数字；<br>\b((?!abc)\w)+\b匹配不包含连续字符串abc的单词。</p><p>零宽度负回顾后发断言(?&lt;!exp),断言此位置的前面不能匹配表达式exp：(?&lt;![a-z])\d{7}匹配前面不是小写字母的七位数字。<br>(?&lt;=&lt;(\w+)&gt;).*(?=&lt;\/\1&gt;)匹配不包含属性的简单HTML标签内里的内容。</p><p>(?&lt;=&lt;(\w+)&gt;)指定了这样的前缀：被尖括号括起来的单词(比如可能是<code>&lt;b&gt;</code>)，然后是.*(任意的字符串),最后是一个后缀(?=&lt;\/\1&gt;)。注意后缀里的\/，它用到了前面提过的字符转义；\1则是一个反向引用，引用的正是捕获的第一组，前面的(\w+)匹配的内容，这样如果前缀实际上是<b>的话，后缀就是</b>了。整个表达式匹配的是<b>和</b>之间的内容(再次提醒，不包括前缀和后缀本身)。</p><h2 id="贪婪与懒惰"><a href="#贪婪与懒惰" class="headerlink" title="贪婪与懒惰"></a>贪婪与懒惰</h2><p>贪婪匹配：当正则表达式中包含能接受重复的限定符时，通常的行为是（在使整个表达式能得到匹配的前提下）匹配尽可能多的字符。以这个表达式为例：a.*b，它将会匹配最长的以a开始，以b结束的字符串。如果用它来搜索aabab的话，它会匹配整个字符串aabab。这被称为贪婪匹配。</p><p>懒惰匹配：匹配尽可能少的字符。前面给出的限定符都可以被转化为懒惰匹配模式，只要在它后面加上一个问号?。<code>这样.*?就意味着匹配任意数量的重复，但是在能使整个匹配成功的前提下使用最少的重复。a.*?b匹配最短的，以a开始，以b结束的字符串。如果把它应用于aabab的话，它会匹配aab（第一到第三个字符）和ab（第四到第五个字符）。</code></p><p>为什么第一个匹配是aab（第一到第三个字符）而不是ab（第二到第三个字符）？简单地说，因为正则表达式有另一条规则，比懒惰／贪婪规则的优先级更高：最先开始的匹配拥有最高的优先权</p><p>8.3.7 平衡组/递归匹配<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">有时我们需要匹配像( 100 * ( 50 + 15 ) )这样的可嵌套的层次性结构，这时简单地使用\(.+\)则只会匹配到最左边的左括号和最右边的右括号之间的内容(这里我们讨论的是贪婪模式，懒惰模式也有下面的问题)。假如原来的字符串里的左括号和右括号出现的次数不相等，比如( 5 / ( 3 + 2 ) ) )，那我们的匹配结果里两者的个数也不会相等。有没有办法在这样的字符串里匹配到最长的，配对的括号之间的内容呢？</div><div class="line"></div><div class="line">为了避免(和\(把你的大脑彻底搞糊涂，我们还是用尖括号代替圆括号吧。现在我们的问题变成了如何把xx &lt;aa &lt;bbb&gt; &lt;bbb&gt; aa&gt; yy这样的字符串里，最长的配对的尖括号内的内容捕获出来？</div></pre></td></tr></table></figure><p></p><p>这里需要用到以下的语法构造：<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(?<span class="string">'group'</span>) 把捕获的内容命名为group,并压入堆栈(Stack)</div><div class="line">(?<span class="string">'-group'</span>) 从堆栈上弹出最后压入堆栈的名为group的捕获内容，如果堆栈本来为空，则本分组的匹配失败</div><div class="line">(?(group)yes|no) 如果堆栈上存在以名为group的捕获内容的话，继续匹配yes部分的表达式，否则继续匹配no部分</div><div class="line">(?!) 零宽负向先行断言，由于没有后缀表达式，试图匹配总是失败</div></pre></td></tr></table></figure><p></p><p>我们需要做的是每碰到了左括号，就在压入一个”Open”,每碰到一个右括号，就弹出一个，到了最后就看看堆栈是否为空－－如果不为空那就证明左括号比右括号多，那匹配就应该失败。正则表达式引擎会进行回溯(放弃最前面或最后面的一些字符)，尽量使整个表达式得到匹配。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;                         <span class="comment">#最外层的左括号</span></div><div class="line">    [^&lt;&gt;]*                <span class="comment">#最外层的左括号后面的不是括号的内容</span></div><div class="line">    (</div><div class="line">        (</div><div class="line">            (?<span class="string">'Open'</span>&lt;)    <span class="comment">#碰到了左括号，在黑板上写一个"Open"</span></div><div class="line">            [^&lt;&gt;]*       <span class="comment">#匹配左括号后面的不是括号的内容</span></div><div class="line">        )+</div><div class="line">        (</div><div class="line">            (?<span class="string">'-Open'</span>&gt;)   <span class="comment">#碰到了右括号，擦掉一个"Open"</span></div><div class="line">            [^&lt;&gt;]*        <span class="comment">#匹配右括号后面不是括号的内容</span></div><div class="line">        )+</div><div class="line">    )*</div><div class="line">    (?(Open)(?!))     <span class="comment">#在遇到最外层的右括号前，判断黑板上还有没有没擦掉的"Open"；如果还有，则匹配失败</span></div><div class="line">&gt;                         <span class="comment">#最外层的右括号</span></div></pre></td></tr></table></figure><p>平衡组的一个最常见的应用就是匹配HTML,下面这个例子可以匹配嵌套的<code>&lt;div&gt;</code>标签<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div[^</span>&gt;</span>]*&gt;[^<span class="tag">&lt;&gt;</span>]*(((?'Open'<span class="tag">&lt;<span class="name">div[^</span>&gt;</span>]*&gt;)[^<span class="tag">&lt;&gt;</span>]*)+((?'-Open'<span class="tag">&lt;/<span class="name">div</span>&gt;</span>)[^<span class="tag">&lt;&gt;</span>]*)+)*(?(Open)(?!))<span class="tag">&lt;/<span class="name">div</span>&gt;</span>.</div></pre></td></tr></table></figure><p></p><h2 id="高效率的正则表达式"><a href="#高效率的正则表达式" class="headerlink" title="高效率的正则表达式"></a>高效率的正则表达式</h2><ul><li>滥用点号、星号和加号是不环保、不负责任的做法。</li><li>每使用一个普通括号()而不是非捕获型括号(?:…)，就会保留一部分内存等着你再次访问。养成合理使用(?:…)括号的习惯。</li><li>将一条复杂的正则表达式拆分为两条或多条简单的正则表达式，编程难度会降低，运行效率会提升。</li><li>例如用来消除行首和行尾空白字符的正则表达式s/^\s+|\s+$//g;，其运行效率理论上要低于s/^\s+//g; s/\s+$//g;</li><li>用肯定环视可以模拟固化分组。</li><li>正则引擎会回溯到存在尚未尝试的多选分支的地方。</li><li>如果使用NFA引擎，必须保证效率（如果能够匹配，必须很快返回匹配结果，若不能匹配，应该尽可能短的时间内报告匹配失败</li></ul><h2 id="正则表达式匹配规则"><a href="#正则表达式匹配规则" class="headerlink" title="正则表达式匹配规则"></a>正则表达式匹配规则</h2><ol><li>优先选择最左端的匹配结果:匹配先从需要查找的字符串的起始位置尝试匹配，并且每一次尝试都要进行到底。</li><li>标准量词是匹配优先的:标准匹配量词的结果“可能“并非所有可能中最长的，但它们总是尝试匹配尽可能多的字符，直到匹配上限为止。</li></ol><p>例如^.<em>([0-9][0-9]) 匹配”about 24 chart”的过程：<br>`.</em>匹配整个字符串之后，第一个[0-9]的匹配要求[.<em>]释放第一个字符”t”(最后的字符)，但是不能让[0-9]匹配，所以.</em>必须继续交还字符，接下来是”r”，直到释放4，但是第二个[0-9]不能匹配，所以再次释放一个字符，就ok，匹配24。`<br>注意，匹配优先的结构只会在被迫的情况下交还字符。</p><h2 id="正则引擎"><a href="#正则引擎" class="headerlink" title="正则引擎"></a>正则引擎</h2><ol><li>DFA（确定型有穷自动机）</li><li>传统的NFA（非确定型有穷自动机）</li><li>POSIX NFA</li><li>DFA/NFA混合</li></ol><p>回溯：NFA引擎在依次处理各个子表达式或组成元素，遇到需要在两个可能成功的可能中进行选择的时候，它会选择其一，同时记住另一个（备用状态），以备稍后可能的需要。<br>只要引擎报告匹配失败，它必然尝试了所有的可能。</p><h2 id="本文永久链接"><a href="#本文永久链接" class="headerlink" title="本文永久链接"></a>本文永久链接</h2><p><a href="http://yanglonglong.com/blog/2016-06-20-%E4%BD%BF%E7%94%A8-JavaScript-%E7%8E%A9%E8%BD%AC%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.html">使用 JavaScript 玩转正则表达式</a><br>（完）</p></div><div></div><div></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/JavaScript/" rel="tag">#JavaScript</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/blog/2016-06-11-使用RequireJS来实现代码模块化.html" rel="next" title="使用RequireJS来实现代码模块化"><i class="fa fa-chevron-left"></i> 使用RequireJS来实现代码模块化</a></div><div class="post-nav-prev post-nav-item"> <a href="/blog/2016-06-24-我的VIM-终极配置方案.html" rel="prev" title="我的VIM 终极配置方案">我的VIM 终极配置方案<i class="fa fa-chevron-right"></i></a></div></div></footer></article><div style="text-align:center;margin-top:15px"> 本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/">知识共享署名-非商业性使用-禁止演绎 3.0 未本地化版本许可协议</a>进行许可。<p>作者：<a href="http://www.yanglonglong.com">杨龙龙</a>，订阅：<a href="http://www.yanglonglong.com/rss.xml">RSS</a></p></div><div class="post-spread"></div></div></div><div class="comments" id="comments"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview"> 站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="http://yanglonglong.com/photos/person/headimg.JPG" alt="杨龙龙"><p class="site-author-name" itemprop="name">杨龙龙</p><p class="site-description motion-element" itemprop="description">前端工程师</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives"><span class="site-state-item-count">36</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories"><span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags"><span class="site-state-item-count">20</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/rss.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/yllziv" target="_blank" title="github"><i class="fa fa-github"></i> github</a></span><span class="links-of-author-item"><a href="mailto:me@yanglonglong.com" target="_blank" title="邮箱"><i class="fa fa-envelope-o"></i> 邮箱</a></span><span class="links-of-author-item"><a href="https://twitter.com/zivyangll" target="_blank" title="twitter"><i class="fa fa-twitter"></i> twitter</a></span><span class="links-of-author-item"><a href="https://www.douban.com/people/ziv_yll/" target="_blank" title="豆瓣"><i class="fa fa-globe"></i> 豆瓣</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/hapyy520/" target="_blank" title="知乎"><i class="fa fa-globe"></i> 知乎</a></span><span class="links-of-author-item"><a href="https://www.instagram.com/yll.ziv/" target="_blank" title="instagram"><i class="fa fa-instagram"></i> instagram</a></span></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="http://blog.liuxj.com/" title="刘宵婧的个人主页" target="_blank">刘宵婧的个人主页</a></li></ul></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#概述"><span class="nav-number">1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JavaScript-中的-RegExp-对象"><span class="nav-number">2.</span> <span class="nav-text">JavaScript 中的 RegExp 对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建一个正则表达式"><span class="nav-number">2.1.</span> <span class="nav-text">创建一个正则表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#以字面量形式定义正则表达式"><span class="nav-number">2.1.1.</span> <span class="nav-text">以字面量形式定义正则表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#以RegExp构造函数定义正则表达式"><span class="nav-number">2.1.2.</span> <span class="nav-text">以RegExp构造函数定义正则表达式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RegExp实例属性"><span class="nav-number">2.2.</span> <span class="nav-text">RegExp实例属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RegExp实例方法"><span class="nav-number">2.3.</span> <span class="nav-text">RegExp实例方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#exec"><span class="nav-number">2.3.1.</span> <span class="nav-text">exec()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#test"><span class="nav-number">2.3.2.</span> <span class="nav-text">test()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#其他方法"><span class="nav-number">2.3.3.</span> <span class="nav-text">其他方法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RegExp构造函数属性"><span class="nav-number">2.4.</span> <span class="nav-text">RegExp构造函数属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JavaScript-对正则支持的局限性"><span class="nav-number">2.5.</span> <span class="nav-text">JavaScript 对正则支持的局限性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JavaScript-中字符串对正则的支持"><span class="nav-number">3.</span> <span class="nav-text">JavaScript 中字符串对正则的支持</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#replace"><span class="nav-number">3.1.</span> <span class="nav-text">replace()</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#replace-第二个参数是字符串"><span class="nav-number">3.1.1.</span> <span class="nav-text">replace 第二个参数是字符串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#replace-第二个参数是函数"><span class="nav-number">3.1.2.</span> <span class="nav-text">replace 第二个参数是函数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#match"><span class="nav-number">3.2.</span> <span class="nav-text">match()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#split"><span class="nav-number">3.3.</span> <span class="nav-text">split()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#search"><span class="nav-number">3.4.</span> <span class="nav-text">search()</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#正则表达式元字符"><span class="nav-number">4.</span> <span class="nav-text">正则表达式元字符</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简单元字符"><span class="nav-number">4.1.</span> <span class="nav-text">简单元字符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#复杂元字符"><span class="nav-number">4.2.</span> <span class="nav-text">复杂元字符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JavaScript-不支持的元字符"><span class="nav-number">4.3.</span> <span class="nav-text">JavaScript 不支持的元字符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#正则表达式修饰符"><span class="nav-number">4.4.</span> <span class="nav-text">正则表达式修饰符</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#正则表达式举例"><span class="nav-number">5.</span> <span class="nav-text">正则表达式举例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#向后引用"><span class="nav-number">6.</span> <span class="nav-text">向后引用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#零宽断言"><span class="nav-number">7.</span> <span class="nav-text">零宽断言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#负向零宽断言"><span class="nav-number">8.</span> <span class="nav-text">负向零宽断言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#贪婪与懒惰"><span class="nav-number">9.</span> <span class="nav-text">贪婪与懒惰</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#高效率的正则表达式"><span class="nav-number">10.</span> <span class="nav-text">高效率的正则表达式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#正则表达式匹配规则"><span class="nav-number">11.</span> <span class="nav-text">正则表达式匹配规则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#正则引擎"><span class="nav-number">12.</span> <span class="nav-text">正则引擎</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#本文永久链接"><span class="nav-number">13.</span> <span class="nav-text">本文永久链接</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2015 - <span itemprop="copyrightYear">2017</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">杨龙龙</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("BmuPD1RNfHPGtYM3h2G54XVc-gzGzoHsz","jO5G91I9DFMgH4TqeBdGXDhE")</script><script>function showTime(e){var t=new AV.Query(e),n=[],o=$(".leancloud_visitors");o.each(function(){n.push($(this).attr("id").trim())}),t.containedIn("url",n),t.find().done(function(e){var t=".leancloud-visitors-count";if(0===e.length)return void o.find(t).text(0);for(var n=0;n<e.length;n++){var i=e[n],r=i.get("url"),l=i.get("time"),s=document.getElementById(r);$(s).find(t).text(l)}}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var r=new e;r.set("title",o),r.set("url",n),r.set("time",1),r.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script><script type="text/javascript" async src="//push.zhanzhang.baidu.com/push.js"></script></body></html>