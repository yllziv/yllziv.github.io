<!doctype html><html class="theme-next pisces"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/vendors/fancybox/source/jquery.fancybox.css" rel="stylesheet" type="text/css"><link href="/vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="/css/main.css" rel="stylesheet" type="text/css"><meta name="keywords" content="Chrome,"><link rel="alternate" href="/rss.xml" title="ziv小站" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"><meta name="description" content="概述chrome应用和扩展的区别Chrome扩展主要用于对浏览器功能的增强，它更强调与浏览器相结合。比如Chrome扩展可以在浏览器的工具栏和地址栏中显示图标，它可以更改用户当前浏览的网页中的内容，也可以更改浏览器代理服务器的设置等等。 Chrome应用更强调是独立的程序，你可以不打开Chrome浏览器而运行这些程序。同时这些程序可以调用更加底层的系统接口，比如串口、USB、本地文件读写等等。同时"><meta name="keywords" content="Chrome"><meta property="og:type" content="article"><meta property="og:title" content="开发 Chrome 插件和应用"><meta property="og:url" content="http://yanglonglong.com/blog/2016-07-05-开发-Chrome-插件和应用.html"><meta property="og:site_name" content="ziv小站"><meta property="og:description" content="概述chrome应用和扩展的区别Chrome扩展主要用于对浏览器功能的增强，它更强调与浏览器相结合。比如Chrome扩展可以在浏览器的工具栏和地址栏中显示图标，它可以更改用户当前浏览的网页中的内容，也可以更改浏览器代理服务器的设置等等。 Chrome应用更强调是独立的程序，你可以不打开Chrome浏览器而运行这些程序。同时这些程序可以调用更加底层的系统接口，比如串口、USB、本地文件读写等等。同时"><meta property="og:locale" content="zh-Hans"><meta property="og:updated_time" content="2016-07-24T07:14:31.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="开发 Chrome 插件和应用"><meta name="twitter:description" content="概述chrome应用和扩展的区别Chrome扩展主要用于对浏览器功能的增强，它更强调与浏览器相结合。比如Chrome扩展可以在浏览器的工具栏和地址栏中显示图标，它可以更改用户当前浏览的网页中的内容，也可以更改浏览器代理服务器的设置等等。 Chrome应用更强调是独立的程序，你可以不打开Chrome浏览器而运行这些程序。同时这些程序可以调用更加底层的系统接口，比如串口、USB、本地文件读写等等。同时"><script type="text/javascript" id="hexo.configuration">var NexT=window.NexT||{},CONFIG={scheme:"Pisces",sidebar:{position:"left",display:"post"},fancybox:!0,motion:!1,duoshuo:{userId:0x56ab38cf59400400,author:"博主"}};!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];"https"===e?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}();var _hmt=_hmt||[];!function(){var t=document.createElement("script");t.src="//hm.baidu.com/hm.js?830d141512282f99a813d8a04a08afde";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><title> 开发 Chrome 插件和应用 | ziv小站</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-76641751-1","auto"),ga("send","pageview")</script><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?830d141512282f99a813d8a04a08afde";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div class="container one-collumn sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">ziv小站</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">杨龙龙的个人博客</p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-home fa-fw"></i><br> 首页</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-archive fa-fw"></i><br> 归档</a></li><li class="menu-item menu-item-life"><a href="/life" rel="section"><i class="menu-item-icon fa fa-life-ring fa-fw"></i><br> 生活</a></li><li class="menu-item menu-item-photos"><a href="/photos" rel="section"><i class="menu-item-icon fa fa-camera-retro fa-fw"></i><br> 相册</a></li><li class="menu-item menu-item-grid"><a href="/grid" rel="section"><i class="menu-item-icon fa fa-calendar fa-fw"></i><br> 格志</a></li><li class="menu-item menu-item-tool"><a href="/tool" rel="section"><i class="menu-item-icon fa fa-legal fa-fw"></i><br> 工具</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline"> 开发 Chrome 插件和应用</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2016-07-05T20:23:27+08:00" content="2016-07-05">2016-07-05</time></span> <span class="post-category">&nbsp; | &nbsp;<span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a href="/categories/tool/" itemprop="url" rel="index"><span itemprop="name">tool</span></a></span></span> <span id="/blog/2016-07-05-开发-Chrome-插件和应用.html" class="leancloud_visitors" data-flag-title="开发 Chrome 插件和应用">&nbsp; | &nbsp;<span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数</span><span class="leancloud-visitors-count"></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><h3 id="chrome应用和扩展的区别"><a href="#chrome应用和扩展的区别" class="headerlink" title="chrome应用和扩展的区别"></a>chrome应用和扩展的区别</h3><p>Chrome扩展主要用于对浏览器功能的增强，它更强调与浏览器相结合。比如Chrome扩展可以在浏览器的工具栏和地址栏中显示图标，它可以更改用户当前浏览的网页中的内容，也可以更改浏览器代理服务器的设置等等。</p><p>Chrome应用更强调是独立的程序，你可以不打开Chrome浏览器而运行这些程序。同时这些程序可以调用更加底层的系统接口，比如串口、USB、本地文件读写等等。同时Chrome应用可以拥有样式更加自由的独立窗口，而Chrome扩展的界面只能限定在浏览器窗口中。</p><h3 id="chrome扩展被安装后的操作"><a href="#chrome扩展被安装后的操作" class="headerlink" title="chrome扩展被安装后的操作"></a>chrome扩展被安装后的操作</h3><p>Chrome扩展是一系列文件的集合，这些文件包括HTML文件、CSS样式文件、JavaScript脚本文件、图片等静态文件以及manifest.json。个别扩展还会包含二进制文件，如DLL动态库和so动态库等。</p><p>扩展被安装后，Chrome就会读取扩展中的manifest.json文件，其内容是按照一定格式描述的扩展相关信息，如扩展名称、版本、更新地址、请求的权限、扩展的UI界面入口等等。这样Chrome就可以知道在浏览器中如何呈现这个扩展，以及这个扩展如何同用户进行交互。</p><h3 id="扩展位置："><a href="#扩展位置：" class="headerlink" title="扩展位置："></a>扩展位置：</h3><p>Chrome扩展的启动入口：浏览器的工具栏、地址栏中、后台默默运行。</p><h2 id="第一个chrome扩展"><a href="#第一个chrome扩展" class="headerlink" title="第一个chrome扩展"></a>第一个chrome扩展</h2><h3 id="首先新建mainfest-json文件："><a href="#首先新建mainfest-json文件：" class="headerlink" title="首先新建mainfest.json文件："></a>首先新建mainfest.json文件：</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    "manifest_version": 2,</div><div class="line">    "name": "我的时钟",  </div><div class="line">    "version": "1.0", // 扩展详细信息里显示</div><div class="line">    "description": "我的第一个Chrome扩展",  // 在扩展的详细信息里显示</div><div class="line">    "icons": &#123;</div><div class="line">        "16": "images/icon16.png",</div><div class="line">        "48": "images/icon48.png",</div><div class="line">        "128": "images/icon128.png"</div><div class="line">    &#125;,</div><div class="line">    "browser_action": &#123;</div><div class="line">        "default_icon": &#123;</div><div class="line">            "19": "images/icon19.png",</div><div class="line">            "38": "images/icon38.png"</div><div class="line">        &#125;,</div><div class="line">        "default_title": "我的时钟", // 鼠标移动到扩展上显示</div><div class="line">        "default_popup": "popup.html"</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><ul><li>目前来说manifest_version属性值只能为数字2。</li><li>对于应用，mainfest.json还必须包含app属性。</li><li>不同地方用不同的尺寸，比如浏览器工具栏里用19像素的，视网膜屏幕用38像素的，扩展程序管理列表里用的48像素的，安装时的弹窗用的128像素的，网页窗口中的图标用的16像素的。</li></ul><h3 id="编写popup-html"><a href="#编写popup-html" class="headerlink" title="编写popup.html"></a>编写popup.html</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></div><div class="line">* &#123;</div><div class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</div><div class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;&#125;</div><div class="line"><span class="selector-tag">body</span> &#123;</div><div class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</div><div class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;&#125;</div><div class="line"><span class="selector-tag">div</span> &#123;</div><div class="line">  <span class="attribute">line-height</span>: <span class="number">100px</span>;</div><div class="line">  <span class="attribute">font-size</span>: <span class="number">42px</span>;</div><div class="line">  <span class="attribute">text-align</span>: center;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"clock_div"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/my_clock.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure><h3 id="编写my-clock-js文件"><a href="#编写my-clock-js文件" class="headerlink" title="编写my_clock.js文件"></a>编写my_clock.js文件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">my_clock</span>(<span class="params">el</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> today=<span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">  <span class="keyword">var</span> h=today.getHours();</div><div class="line">  <span class="keyword">var</span> m=today.getMinutes();</div><div class="line">  <span class="keyword">var</span> s=today.getSeconds();</div><div class="line">  m=m&gt;=<span class="number">10</span>?m:(<span class="string">'0'</span>+m);</div><div class="line">  s=s&gt;=<span class="number">10</span>?s:(<span class="string">'0'</span>+s);</div><div class="line">  el.innerHTML = h+<span class="string">":"</span>+m+<span class="string">":"</span>+s;</div><div class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;my_clock(el)&#125;, <span class="number">1000</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> clock_div = <span class="built_in">document</span>.getElementById(<span class="string">'clock_div'</span>);</div><div class="line">my_clock(clock_div);</div></pre></td></tr></table></figure><h3 id="新建images文件夹："><a href="#新建images文件夹：" class="headerlink" title="新建images文件夹："></a>新建images文件夹：</h3><h3 id="加载chrome扩展"><a href="#加载chrome扩展" class="headerlink" title="加载chrome扩展"></a>加载chrome扩展</h3><p>依次点击“”-“工具”-“扩展程序”打开扩展程序页面，勾选右上角的“开发者模式”，点击“加载正在开发的扩展程序”，选择扩展所在的文件夹，就可以在浏览器工具栏中看到我们的扩展了。</p><h3 id="manifest-json模板"><a href="#manifest-json模板" class="headerlink" title="manifest.json模板"></a>manifest.json模板</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    "app": &#123;</div><div class="line">        "background": &#123;</div><div class="line">            "scripts": ["background.js"]</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    "manifest_version": 2,</div><div class="line">    "name": "My Extension",</div><div class="line">    "version": "versionString",</div><div class="line">    "default_locale": "en",</div><div class="line">    "description": "A plain text description",</div><div class="line">    "icons": &#123;</div><div class="line">        "16": "images/icon16.png",</div><div class="line">        "48": "images/icon48.png",</div><div class="line">        "128": "images/icon128.png"</div><div class="line">    &#125;,</div><div class="line">    "browser_action": &#123;</div><div class="line">        "default_icon": &#123;</div><div class="line">            "19": "images/icon19.png",</div><div class="line">            "38": "images/icon38.png"</div><div class="line">        &#125;,</div><div class="line">        "default_title": "Extension Title",</div><div class="line">        "default_popup": "popup.html"</div><div class="line">    &#125;,</div><div class="line">    "page_action": &#123;</div><div class="line">        "default_icon": &#123;</div><div class="line">            "19": "images/icon19.png",</div><div class="line">            "38": "images/icon38.png"</div><div class="line">        &#125;,</div><div class="line">        "default_title": "Extension Title",</div><div class="line">        "default_popup": "popup.html"</div><div class="line">    &#125;,</div><div class="line">    "background": &#123;</div><div class="line">        "scripts": ["background.js"]</div><div class="line">    &#125;,</div><div class="line">    "content_scripts": [ // 指定注入脚本，当用户访问页面后相应脚本自动运行，从而对页面DOM进行操作。</div><div class="line">        &#123;</div><div class="line">            "matches": ["*://www.google.com/"], // 定义了哪些页面会被注入脚本</div><div class="line">            "css": ["mystyles.css"], // 要注入的样式表和JavaScript</div><div class="line">            "js": ["jquery.js", "myscript.js"]</div><div class="line">        &#125;</div><div class="line">    ],</div><div class="line">    "options_page": "options.html", // 选项页面</div><div class="line">    "permissions": [</div><div class="line">        "*://www.google.com/*"</div><div class="line">    ],</div><div class="line">    "web_accessible_resources": [ // 列出需要引入的资源</div><div class="line">        "images/*.png"</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="Chrome扩展基础"><a href="#Chrome扩展基础" class="headerlink" title="Chrome扩展基础"></a>Chrome扩展基础</h2><h3 id="永远点不到百度一下"><a href="#永远点不到百度一下" class="headerlink" title="永远点不到百度一下"></a>永远点不到百度一下</h3><p>创建Manifest文件<br></p><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"manifest_version"</span>: <span class="number">2</span>,</div><div class="line">    <span class="attr">"name"</span>: <span class="string">"永远点不到的搜索按钮"</span>,</div><div class="line">    <span class="attr">"version"</span>: <span class="string">"1.0"</span>,</div><div class="line">    <span class="attr">"description"</span>: <span class="string">"让你永远也点击不到Google的搜索按钮"</span>,</div><div class="line">    <span class="attr">"content_scripts"</span>: [</div><div class="line">        &#123;</div><div class="line">            <span class="attr">"matches"</span>: [<span class="string">"*://www.baidu.com/"</span>],</div><div class="line">            <span class="attr">"js"</span>: [<span class="string">"js/cannot_touch.js"</span>]</div><div class="line">        &#125;</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>编写cannot_touch.js<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">btn_move</span>(<span class="params">el, mouseLeft, mouseTop</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> leftRnd = (<span class="built_in">Math</span>.random()<span class="number">-0.5</span>)*<span class="number">20</span>;</div><div class="line">    <span class="keyword">var</span> topRnd = (<span class="built_in">Math</span>.random()<span class="number">-0.5</span>)*<span class="number">20</span>;</div><div class="line">    <span class="keyword">var</span> btnLeft = mouseLeft+(leftRnd&gt;<span class="number">0</span>?<span class="number">100</span>:<span class="number">-100</span>)+leftRnd;</div><div class="line">    <span class="keyword">var</span> btnTop = mouseTop+(topRnd&gt;<span class="number">0</span>?<span class="number">30</span>:<span class="number">-30</span>)+topRnd;</div><div class="line">    btnLeft = btnLeft&lt;<span class="number">100</span>?(btnLeft+<span class="built_in">window</span>.innerWidth<span class="number">-200</span>):(btnLeft&gt;<span class="built_in">window</span>.innerWidth<span class="number">-100</span>?btnLeft-<span class="built_in">window</span>.innerWidth+<span class="number">200</span>:btnLeft);</div><div class="line">    btnTop =  btnTop&lt;<span class="number">100</span>?( btnTop+<span class="built_in">window</span>.innerHeight<span class="number">-200</span>):(btnTop&gt;<span class="built_in">window</span>.innerHeight<span class="number">-100</span>?btnTop-<span class="built_in">window</span>.innerHeight+<span class="number">200</span>:btnTop);</div><div class="line">    el.style.position = <span class="string">'fixed'</span>;</div><div class="line">    el.style.left = btnLeft+<span class="string">'px'</span>;</div><div class="line">    el.style.top = btnTop+<span class="string">'px'</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">over_btn</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(!e)&#123;</div><div class="line">        e = <span class="built_in">window</span>.event;</div><div class="line">    &#125;</div><div class="line">    btn_move(<span class="keyword">this</span>, e.clientX, e.clientY);</div><div class="line">&#125;</div><div class="line"><span class="built_in">document</span>.getElementById(<span class="string">'su'</span>).onmouseover = over_btn;</div></pre></td></tr></table></figure><p></p><p>将指定的脚本文件插入到符合规则的特定页面中，从而使插入的脚本可以对页面的DOM进行操作。</p><h3 id="跨域请求"><a href="#跨域请求" class="headerlink" title="跨域请求"></a>跨域请求</h3><p>Google允许Chrome扩展应用不必受限于跨域限制。但出于安全考虑，需要在Manifest的permissions属性中声明需要跨域的权限。<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"permissions"</span>: [</div><div class="line">  <span class="string">"*://*.wikipedia.org/*"</span> <span class="comment">// 允许获取维基百科的数据</span></div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>查询ip的扩展：<br>mainfest.json文件：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="string">"manifest_version"</span>: <span class="number">2</span>,</div><div class="line">    <span class="string">"name"</span>: <span class="string">"查看我的IP"</span>,</div><div class="line">    <span class="string">"version"</span>: <span class="string">"1.0"</span>,</div><div class="line">    <span class="string">"description"</span>: <span class="string">"查看我的电脑当前的公网IP"</span>,</div><div class="line">    <span class="string">"icons"</span>: &#123;</div><div class="line">        <span class="string">"16"</span>: <span class="string">"images/icon16.png"</span>,</div><div class="line">        <span class="string">"48"</span>: <span class="string">"images/icon48.png"</span>,</div><div class="line">        <span class="string">"128"</span>: <span class="string">"images/icon128.png"</span></div><div class="line">    &#125;,</div><div class="line">    <span class="string">"browser_action"</span>: &#123;</div><div class="line">        <span class="string">"default_icon"</span>: &#123;</div><div class="line">            <span class="string">"19"</span>: <span class="string">"images/icon19.png"</span>,</div><div class="line">            <span class="string">"38"</span>: <span class="string">"images/icon38.png"</span></div><div class="line">        &#125;,</div><div class="line">        <span class="string">"default_title"</span>: <span class="string">"查看我的IP"</span>,</div><div class="line">        <span class="string">"default_popup"</span>: <span class="string">"popup.html"</span></div><div class="line">    &#125;,</div><div class="line">    <span class="string">"permissions"</span>: [</div><div class="line">        <span class="string">"http://int.dpool.sina.com.cn/"</span></div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>popup.html文件：<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></div><div class="line">* &#123;</div><div class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-tag">body</span> &#123;</div><div class="line">    <span class="attribute">width</span>: <span class="number">400px</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-tag">div</span> &#123;</div><div class="line">    <span class="attribute">line-height</span>: <span class="number">100px</span>;</div><div class="line">    <span class="attribute">font-size</span>: <span class="number">42px</span>;</div><div class="line">    <span class="attribute">text-align</span>: center;</div><div class="line">&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"ip_div"</span>&gt;</span>正在查询……<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/my_ip.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure><p></p><p>my_ip.js：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">httpRequest</span>(<span class="params">url, callback</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">  xhr.open(<span class="string">"GET"</span>, url, <span class="literal">true</span>);</div><div class="line">  xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span>) &#123;</div><div class="line">  callback(xhr.responseText);</div><div class="line">  &#125;</div><div class="line">  &#125;</div><div class="line">  xhr.send();&#125;</div><div class="line"></div><div class="line">httpRequest(<span class="string">'http://int.dpool.sina.com.cn/iplookup/iplookup.php?'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">ip</span>)</span>&#123;</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'ip_div'</span>).innerText = ip;</div><div class="line">&#125;);</div></pre></td></tr></table></figure><p></p><h3 id="常驻后台"><a href="#常驻后台" class="headerlink" title="常驻后台"></a>常驻后台</h3><p>在Manifest中指定background域可以使扩展常驻后台。<br>background可以包含三种属性，分别是scripts（扩展启动时自动创建一个包含所有指定脚本的页面 ）、page和persistent（true时扩展将一直在后台运行；false时扩展在后台按需运行，这就是Chrome后来提出的Event Page）。</p><p>实时监视网站在线状态的扩展：<br>每隔5秒就发起一次连接请求，如果请求成功就代表网站在线，将扩展图标显示为绿色，如果请求失败就代表网站不在线，将扩展图标显示为红色。<br>Manifest文件：<br></p><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"manifest_version"</span>: <span class="number">2</span>,</div><div class="line">    <span class="attr">"name"</span>: <span class="string">"Baidu在线状态"</span>,</div><div class="line">    <span class="attr">"version"</span>: <span class="string">"1.0"</span>,</div><div class="line">    <span class="attr">"description"</span>: <span class="string">"监视Baidu是否在线"</span>,</div><div class="line">    <span class="attr">"icons"</span>: &#123;</div><div class="line">        <span class="attr">"16"</span>: <span class="string">"images/icon16.png"</span>,</div><div class="line">        <span class="attr">"48"</span>: <span class="string">"images/icon48.png"</span>,</div><div class="line">        <span class="attr">"128"</span>: <span class="string">"images/icon128.png"</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"browser_action"</span>: &#123;</div><div class="line">        <span class="attr">"default_icon"</span>: &#123;</div><div class="line">            <span class="attr">"19"</span>: <span class="string">"images/icon19.png"</span>,</div><div class="line">            <span class="attr">"38"</span>: <span class="string">"images/icon38.png"</span></div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"background"</span>: &#123;</div><div class="line">        <span class="attr">"scripts"</span>: [</div><div class="line">            <span class="string">"js/status.js"</span></div><div class="line">        ]</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"permissions"</span>: [</div><div class="line">        <span class="string">"http://www.baidu.cn/"</span></div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>由于这个扩展没有UI，所以我们不必编写HTML文件，下面直接编写status.js:<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">httpRequest</span>(<span class="params">url, callback</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">  xhr.open(<span class="string">"GET"</span>, url, <span class="literal">true</span>);</div><div class="line">  xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span>) &#123;</div><div class="line">  callback(<span class="literal">true</span>);</div><div class="line">  &#125;</div><div class="line">  &#125;</div><div class="line">  xhr.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  callback(<span class="literal">false</span>);</div><div class="line">  &#125;</div><div class="line">  xhr.send();&#125;</div><div class="line"></div><div class="line">setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  httpRequest(<span class="string">'http://www.baidu.com/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">status</span>)</span>&#123;</div><div class="line">      chrome.browserAction.setIcon(&#123;<span class="attr">path</span>: <span class="string">'images/'</span>+(status?<span class="string">'online.png'</span>:<span class="string">'offline.png'</span>)&#125;); <span class="comment">// 更换扩展在浏览器工具栏中的图标</span></div><div class="line">  &#125;);</div><div class="line">&#125;,<span class="number">5000</span>);</div></pre></td></tr></table></figure><p></p><h3 id="带选项页面的扩展"><a href="#带选项页面的扩展" class="headerlink" title="带选项页面的扩展"></a>带选项页面的扩展</h3><p>通过Manifest文件的options_page属性可以为扩展指定一个选项页面。<br>设置可以采用多种方式存储：cookie、HTML5的storage，Chrome提供的存储API，使用Web SQL Database。<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    &quot;options_page&quot;: &quot;options.html&quot;,</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><h3 id="扩展页面间的通信"><a href="#扩展页面间的通信" class="headerlink" title="扩展页面间的通信"></a>扩展页面间的通信</h3><p>在popup.html中执行如下代码：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chrome.runtime.sendMessage(<span class="string">'Hello'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span>&#123;</div><div class="line">  <span class="built_in">document</span>.write(response);&#125;);</div></pre></td></tr></table></figure><p></p><p>在background中执行如下代码：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">chrome.runtime.onMessage.addListener(<span class="function"><span class="keyword">function</span>(<span class="params">message, sender, sendResponse</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(message == <span class="string">'Hello'</span>)&#123;</div><div class="line">  sendResponse(<span class="string">'Hello from background.'</span>);</div><div class="line">  &#125;&#125;);</div></pre></td></tr></table></figure><p></p><p>查看popup.html页面会发现有输出“Hello from background.”</p><h3 id="存储数据"><a href="#存储数据" class="headerlink" title="存储数据"></a>存储数据</h3><h4 id="Chrome存储API"><a href="#Chrome存储API" class="headerlink" title="Chrome存储API"></a>Chrome存储API</h4><p>Chrome为扩展应用提供了存储API，以便将扩展中需要保存的数据写入本地磁盘。Chrome提供的存储API可以说是对localStorage的改进，它与localStorage相比有以下区别：</p><ul><li>如果储存区域指定为sync，数据可以自动同步；</li><li>content_scripts可以直接读取数据，而不必通过background页面；</li><li>在隐身模式下仍然可以读出之前存储的数据；</li><li>读写速度更快；</li><li>用户数据可以以对象的类型保存。<br>content_scripts是注入到用户当前浏览页面中的，如果content_scripts直接读取localStorage，所读取到的数据是用户当前浏览页面所在域中的。所以通常的解决办法是content_scripts通过runtime.sendMessage和background通信，由background读写扩展所在域（通常是chrome-extension://extension-id/）的localStorage，然后再传递给content_scripts。</li></ul><p>使用Chrome存储API必须要在Manifest的permissions中声明”storage”，之后才有权限调用。Chrome存储API提供了2种储存区域，分别是sync和local。两种储存区域的区别在于，sync储存的区域会根据用户当前在Chrome上登陆的Google账户自动同步数据，当无可用网络连接可用时，sync区域对数据的读写和local区域对数据的读写行为一致。</p><p>对于每种储存区域，Chrome又提供了5个方法，分别是get、getBytesInUse、set、remove和clear。<br>（1）get方法即为读取数据，完整的方法为：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chrome.storage.StorageArea.get(keys, <span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(result);&#125;);</div></pre></td></tr></table></figure><p></p><p>keys可以是字符串、包含多个字符串的数组或对象。如果keys是字符串，则和localStorage的用法类似；如果是数组，则相当于一次读取了多个数据；如果keys是对象，则会先读取以这个对象属性名为键值的数据，如果这个数据不存在则返回keys对象的属性值（比如keys为{‘name’:’Billy’}，如果name这个值存在，就返回name原有的值，如果不存在就返回Billy）。如果keys为一个空数组（[]）或空对象（{}），则返回一个空列表，如果keys为null，则返回所有存储的数据。</p><p>（2） getBytesInUse方法为获取一个数据或多个数据所占用的总空间，返回结果的单位是字节，完整方法为：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chrome.storage.StorageArea.getBytesInUse(keys, <span class="function"><span class="keyword">function</span>(<span class="params">bytes</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(bytes);&#125;);</div></pre></td></tr></table></figure><p></p><p>此处的keys只能为null、字符串或包含多个字符串的数组。</p><p>（3） set方法为写入数据，完整方法为：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chrome.storage.StorageArea.set(items, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="comment">//do something&#125;);</span></div></pre></td></tr></table></figure><p></p><p>items为对象类型，形式为键/值对。items的属性值如果是字符型、数字型和数组型，则储存的格式不会改变，但如果是对象型和函数型的，会被储存为“{}”，如果是日期型和正则型的，会被储存为它们的字符串形式。</p><p>（4） remove方法为删除数据，完整方法为：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chrome.storage.StorageArea.remove(keys, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="comment">//do something&#125;);</span></div></pre></td></tr></table></figure><p></p><p>其中keys可以是字符串，也可以是包含多个字符串的数组。</p><p>（5） clear方法为删除所有数据，完整方法为：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chrome.storage.StorageArea.clear(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="comment">//do something&#125;);</span></div></pre></td></tr></table></figure><p></p><p>请注意，上述五种完整方法中，StorageArea必须指定为local或sync中的一个。</p><p>Chrome同时还为存储API提供了一个onChanged事件，当存储区的数据发生改变时，这个事件会被激发。<br>onChanged的完整方法为：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">chrome.storage.onChanged.addListener(<span class="function"><span class="keyword">function</span>(<span class="params">changes, areaName</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Value in '</span>+areaName+<span class="string">' has been changed:'</span>);</div><div class="line">  <span class="built_in">console</span>.log(changes);&#125;);</div></pre></td></tr></table></figure><p></p><p>callback会接收到两个参数，第一个为changes，第二个是StorageArea。changes是词典对象，键为更改的属性名称，值包含两个属性，分别为oldValue和newValue；StorageArea为local或sync。</p><h2 id="Chrome扩展的UI界面"><a href="#Chrome扩展的UI界面" class="headerlink" title="Chrome扩展的UI界面"></a>Chrome扩展的UI界面</h2><ul><li>Browser Actions将扩展图标置于Chrome浏览器工具栏中，地址栏的右侧。如果声明了popup页面，当用户点击图标时，在图标的下侧会打开这个页面。同时图标上面还可以附带badge——一个带有显示有限字符空间的区域——用以显示一些有用的信息，如未读邮件数、当前音乐播放时间等。<br>如果没有足够的空间，会在图标的上侧打开。</li><li>右键菜单：要在Manifest的permissions域中声明contextMenus权限。</li><li>桌面提醒：需要在Manifest中声明notifications权限。<br>创建桌面提醒非常容易，只需指定标题、内容和图片即可。下面的代码生成了标题为“Notification Demo”，内容为“Merry Christmas”，图片为“icon48.png”的桌面提醒窗口。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> notification = webkitNotifications.createNotification(</div><div class="line">  <span class="string">'icon48.png'</span>,</div><div class="line">  <span class="string">'Notification Demo'</span>,</div><div class="line">  <span class="string">'Merry Christmas'</span>);</div></pre></td></tr></table></figure></li></ul><p>桌面系统窗口创建之后是不会立刻显示出来的，为了让其显示，还要调用show方法：<br>notification.show();</p><ul><li>Chrome和其他浏览器相比一个最大的区别就是地址栏——其实不仅仅是地址栏，而是一个多功能的输入框，Google将其称为omnibox（中文为“多功能框”）。我们熟悉的一个功能就是用户可以直接在omnibox搜索关键字，Chrome也将omnibox开放给开发者，这使得omnibox更加强大。</li></ul><h2 id="管理浏览器"><a href="#管理浏览器" class="headerlink" title="管理浏览器"></a>管理浏览器</h2><ul><li>书签：要在扩展中操作书签，需要在Manifest中声明bookmarks权限。</li><li>Cookies，需要在Manifest中声明cookies权限，同时也要声明所需管理Cookies所在的域。</li><li>历史，需要在Manifest中声明history权限。</li><li>管理扩展与应用：management接口可以获取用户已安装的扩展和应用信息，同时还可以卸载和禁用它们。需要在Manifest中声明management权限。</li><li>标签，需要声明tabs权限。</li><li>override pages，用自定义的页面替换Chrome相应默认的页面，目前支持替换的页面包含Chrome的书签页面、历史记录和新标签页面。</li><li>下载，提供了downloads API，扩展可以通过此API管理浏览器的下载功能，包括暂停、搜索和取消等。需要在Manifest文件中声明downloads权限。</li><li>网络请求，提供了较为完整的方法供扩展程序分析、阻断及更改网络请求，同时也提供了一系列较为全面的监听事件以监听整个网络请求生命周期的各个阶段。网络请求的整个生命周期所触发事件的时间顺序如下图所示。需要在Manifest中声明webRequest权限以及相关被操作的URL。</li><li>代理，代理可以让用户通过代理服务器浏览网络资源以达到匿名访问等目的。代理的类型有多种，常用的包括http代理和socks代理等。Chrome浏览器提供了代理设置管理接口，这样可以让扩展来做到更加智能的代理设置。要让扩展使用代理接口，需要声明proxy权限：<br>“permissions”: [<br>“proxy”]</li><li>系统信息，Chrome提供了获取系统CPU、内存和存储设备的信息，要获取这些信息，需要在Manifest中分别声明如下权限：<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">"permissions": [</div><div class="line">  "system.cpu",</div><div class="line">  "system.memory",</div><div class="line">  "system.storage"]</div></pre></td></tr></table></figure></li></ul><h2 id="编写第一个chrome应用"><a href="#编写第一个chrome应用" class="headerlink" title="编写第一个chrome应用"></a>编写第一个chrome应用</h2><p>在编写Chrome应用时请时刻记住，这已经不是单纯地开发浏览器扩展了，现在要编写的是一款真正的桌面程序，而Chrome只是类似CLR和Java的环境而已。<br>创建Manifest文件：<br></p><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"app"</span>: &#123;</div><div class="line">  <span class="attr">"background"</span>: &#123;</div><div class="line">  <span class="attr">"scripts"</span>: [<span class="string">"background.js"</span>]</div><div class="line">  &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"manifest_version"</span>: <span class="number">2</span>,</div><div class="line">  <span class="attr">"name"</span>: <span class="string">"Performance Monitor"</span>,</div><div class="line">  <span class="attr">"version"</span>: <span class="string">"1.0"</span>,</div><div class="line">  <span class="attr">"description"</span>: <span class="string">"A performance monitor to show cpu and memory status."</span>,</div><div class="line">  <span class="attr">"icons"</span>: &#123;</div><div class="line">  <span class="attr">"16"</span>: <span class="string">"images/icon16.png"</span>,</div><div class="line">  <span class="attr">"48"</span>: <span class="string">"images/icon48.png"</span>,</div><div class="line">  <span class="attr">"128"</span>: <span class="string">"images/icon128.png"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"permissions"</span>: [</div><div class="line">  <span class="string">"system.cpu"</span>,</div><div class="line">  <span class="string">"system.memory"</span></div><div class="line">  ]&#125;</div></pre></td></tr></table></figure><p></p><p>编写background.js脚本：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">chrome.app.runtime.onLaunched.addListener(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  chrome.app.window.create(<span class="string">'main.html'</span>, &#123;</div><div class="line">  <span class="string">'id'</span>: <span class="string">'main'</span>,</div><div class="line">  <span class="string">'bounds'</span>: &#123;</div><div class="line">  <span class="string">'width'</span>: <span class="number">542</span>,</div><div class="line">  <span class="string">'height'</span>: <span class="number">360</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">'resizable'</span>: <span class="literal">false</span>,</div><div class="line">  <span class="string">'frame'</span>: <span class="string">'none'</span></div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure><p></p><p>chrome应用可以进行的操作：</p><ul><li>文件系统：目录及文件操作对象、获取目录及文件操作对象、读取文件、遍历目录、创建及删除目录和文件、写入文件、复制及移动目录和文件。</li><li>媒体库：- 获取媒体库、添加及移除媒体库、更新媒体库、获取媒体文件信息。</li><li>网络通信：UDP协议、TCP协议、TCP Server、WebSocket。</li><li>操作USB设备、串口通信、文字转语音、系统信息。</li></ul><h2 id="本文永久链接"><a href="#本文永久链接" class="headerlink" title="本文永久链接"></a>本文永久链接</h2><p><a href="http://yanglonglong.com/blog/2016-07-05-%E5%BC%80%E5%8F%91-Chrome-%E6%8F%92%E4%BB%B6%E5%92%8C%E5%BA%94%E7%94%A8.html">开发 Chrome 插件和应用</a><br>（完）</p></div><div></div><div></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/Chrome/" rel="tag">#Chrome</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/blog/2016-07-03-玩转-Chrome-控制台.html" rel="next" title="玩转 Chrome 控制台"><i class="fa fa-chevron-left"></i> 玩转 Chrome 控制台</a></div><div class="post-nav-prev post-nav-item"> <a href="/blog/2016-07-21-Git-使用两年后的一个总结.html" rel="prev" title="Git 使用两年后的一个总结">Git 使用两年后的一个总结<i class="fa fa-chevron-right"></i></a></div></div></footer></article><div style="text-align:center;margin-top:15px"> 本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/">知识共享署名-非商业性使用-禁止演绎 3.0 未本地化版本许可协议</a>进行许可。<p>作者：<a href="http://www.yanglonglong.com">杨龙龙</a>，订阅：<a href="http://www.yanglonglong.com/rss.xml">RSS</a></p></div><div class="post-spread"></div></div></div><div class="comments" id="comments"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview"> 站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="http://yanglonglong.com/photos/person/headimg.JPG" alt="杨龙龙"><p class="site-author-name" itemprop="name">杨龙龙</p><p class="site-description motion-element" itemprop="description">前端工程师</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives"><span class="site-state-item-count">36</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories"><span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags"><span class="site-state-item-count">20</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/rss.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/yllziv" target="_blank" title="github"><i class="fa fa-github"></i> github</a></span><span class="links-of-author-item"><a href="mailto:me@yanglonglong.com" target="_blank" title="邮箱"><i class="fa fa-envelope-o"></i> 邮箱</a></span><span class="links-of-author-item"><a href="https://twitter.com/zivyangll" target="_blank" title="twitter"><i class="fa fa-twitter"></i> twitter</a></span><span class="links-of-author-item"><a href="https://www.douban.com/people/ziv_yll/" target="_blank" title="豆瓣"><i class="fa fa-globe"></i> 豆瓣</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/hapyy520/" target="_blank" title="知乎"><i class="fa fa-globe"></i> 知乎</a></span><span class="links-of-author-item"><a href="https://www.instagram.com/yll.ziv/" target="_blank" title="instagram"><i class="fa fa-instagram"></i> instagram</a></span></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="http://blog.liuxj.com/" title="刘宵婧的个人主页" target="_blank">刘宵婧的个人主页</a></li></ul></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#概述"><span class="nav-number">1.</span> <span class="nav-text">概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#chrome应用和扩展的区别"><span class="nav-number">1.1.</span> <span class="nav-text">chrome应用和扩展的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#chrome扩展被安装后的操作"><span class="nav-number">1.2.</span> <span class="nav-text">chrome扩展被安装后的操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#扩展位置："><span class="nav-number">1.3.</span> <span class="nav-text">扩展位置：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第一个chrome扩展"><span class="nav-number">2.</span> <span class="nav-text">第一个chrome扩展</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#首先新建mainfest-json文件："><span class="nav-number">2.1.</span> <span class="nav-text">首先新建mainfest.json文件：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#编写popup-html"><span class="nav-number">2.2.</span> <span class="nav-text">编写popup.html</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#编写my-clock-js文件"><span class="nav-number">2.3.</span> <span class="nav-text">编写my_clock.js文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#新建images文件夹："><span class="nav-number">2.4.</span> <span class="nav-text">新建images文件夹：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#加载chrome扩展"><span class="nav-number">2.5.</span> <span class="nav-text">加载chrome扩展</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#manifest-json模板"><span class="nav-number">2.6.</span> <span class="nav-text">manifest.json模板</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Chrome扩展基础"><span class="nav-number">3.</span> <span class="nav-text">Chrome扩展基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#永远点不到百度一下"><span class="nav-number">3.1.</span> <span class="nav-text">永远点不到百度一下</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#跨域请求"><span class="nav-number">3.2.</span> <span class="nav-text">跨域请求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常驻后台"><span class="nav-number">3.3.</span> <span class="nav-text">常驻后台</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#带选项页面的扩展"><span class="nav-number">3.4.</span> <span class="nav-text">带选项页面的扩展</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#扩展页面间的通信"><span class="nav-number">3.5.</span> <span class="nav-text">扩展页面间的通信</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#存储数据"><span class="nav-number">3.6.</span> <span class="nav-text">存储数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Chrome存储API"><span class="nav-number">3.6.1.</span> <span class="nav-text">Chrome存储API</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Chrome扩展的UI界面"><span class="nav-number">4.</span> <span class="nav-text">Chrome扩展的UI界面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#管理浏览器"><span class="nav-number">5.</span> <span class="nav-text">管理浏览器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#编写第一个chrome应用"><span class="nav-number">6.</span> <span class="nav-text">编写第一个chrome应用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#本文永久链接"><span class="nav-number">7.</span> <span class="nav-text">本文永久链接</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2015 - <span itemprop="copyrightYear">2017</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">杨龙龙</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("BmuPD1RNfHPGtYM3h2G54XVc-gzGzoHsz","jO5G91I9DFMgH4TqeBdGXDhE")</script><script>function showTime(e){var t=new AV.Query(e),n=[],o=$(".leancloud_visitors");o.each(function(){n.push($(this).attr("id").trim())}),t.containedIn("url",n),t.find().done(function(e){var t=".leancloud-visitors-count";if(0===e.length)return void o.find(t).text(0);for(var n=0;n<e.length;n++){var i=e[n],r=i.get("url"),l=i.get("time"),s=document.getElementById(r);$(s).find(t).text(l)}}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var r=new e;r.set("title",o),r.set("url",n),r.set("time",1),r.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script><script type="text/javascript" async src="//push.zhanzhang.baidu.com/push.js"></script></body></html>